/*
 * Copyright (c) 2013, SRI International
 * All rights reserved.
 * Licensed under the The BSD 3-Clause License;
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at:
 * 
 * http://opensource.org/licenses/BSD-3-Clause
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 
 * Redistributions of source code must retain the above copyright
 * notice, this list of conditions and the following disclaimer.
 * 
 * Redistributions in binary form must reproduce the above copyright
 * notice, this list of conditions and the following disclaimer in the
 * documentation and/or other materials provided with the distribution.
 * 
 * Neither the name of the aic-util nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
 * FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
 * COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, 
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES 
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) 
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, 
 * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) 
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
 * OF THE POSSIBILITY OF SUCH DAMAGE.
 */

/* <b>Note:</b> Tests closely based on those in freely available version of 
 * 'BigRational.java', developed by Eric Laroche, which can be found at: <a
 * href="http://www.lrdev.com/lr/java/">http://www.lrdev.com/lr/java/</a>
 * BigRational.java -- dynamically sized big rational numbers.
**
** Copyright (C) 2002-2010 Eric Laroche.  All rights reserved.
**
** @author Eric Laroche <laroche@lrdev.com>
** @version @(#)$Id: BigRational.java,v 1.3 2010/03/24 20:11:34 laroche Exp $
**
** This program is free software;
** you can redistribute it and/or modify it.
**
** This program is distributed in the hope that it will be useful,
** but WITHOUT ANY WARRANTY; without even the implied warranty of
** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
**
*/
package com.sri.ai.test.util.math;

import org.junit.Assert;
import org.junit.Ignore;
import org.junit.Test;

import com.sri.ai.util.math.Rational;

/**
 * @author Eric Laroche <laroche@lrdev.com>
 * @author oreilly
 *
 */
public class RationalTest {

	@Test
	public void testDefaultRadix() {
		Assert.assertEquals(10, Rational.DEFAULT_RADIX);
	}

	@Test(expected = NumberFormatException.class)
	public void testZeroDenominator() {
		new Rational(2, 0);
	}
	
	@Ignore("TODO - currently experimental")
	@Test
	public void testPowLargeIntegerExponent() {
// NOTE: Currently 3^Integer.MAX_VALUE appears to take very long time in BigInteger.pow()		
		Rational exponent = new Rational(10000000000L);
		System.out.println("exponent="+exponent);
		Rational base = new Rational("3");
		System.out.println("base="+base);
		Rational result = base.pow(exponent);
		System.out.println("b^e="+result);
	}
	
	@Ignore("TODO - currently experimental")
	@Test
	public void testPowRationalV1() {
		// From: testProductWithLotsOfSamplesV2
		Rational product = new Rational("13181935603632054548996322676053991850952440664869460333342613947447372537562056106406345127218542030029237746886887800480331314394054669586758359967756662977976443064163854832464450001059614523411667145429943053271481176781866779593166050631756645249644980258663489693637267522538405699768008517581565984121053059098080254877141640243102069195065429739737514178603917203776547150496897919427112691954521997392288736689763724428582875971956084218487630596340775071449150883087078028295483907558489249059603946371982995857811202407470916937101179143520494663221249425474741386593246420314462742989693944231781369458725238094615271936437936460113094631943683613133157597231229155603119247897087497811894720844403562878694270405785182146868396511859256246619669846180316397090056103823658462287068608069819465198661442220320980302749428178178884962651818576738288072846114074306254812981848942059271548236910817758358296938256877174282288466480947608640519294482959895561516525807928003188173320464690278009271524311780937021437449973880341890375690965423993019209025719464706323729908037495336979863000490151599612138805241337075110932087571936106195234552406947457728680443005856687137970862341784536283235618601898718908485874387718237801950837173334208774552455867558157543281207106899255090795506489942896531108821414968948596663735589963273317167400808911222603813619663915654176785013202403883958545741295200687981069711124854875982967446360062840552606414478220993561603282732802452465303987655151792346914916301893953748082061488791358018284493115142863035062283986028499731980549270586815616351838987903652138533702037915176081674181104222619537760007538599656269544186203981670613473308808151114729105575641212130793805887854364810750881646968462699774803927142090587325827534757383426369058304690473564954341563886367281288279043761340696488093827551161708641892645557307190434431307942916802838018475817635270709331581212208243160364576794366090398435301922458338248090332395859163777805580453391369602925658851632691440826205688219966491620898059089952742691314876865762240219235068292336116173929169333125979035645475582541525697390855900174444372987235413197081042468967697581052031681287531599421959627905835671306715241368950799389550030825509933349984603748671709061951756207348609024337565808175597030997612034554037022638935624650516363301049679139106264010903534269279920813682371006611813021563308457888755218970457424778278855381005320697286906268778716672292504691487008462499198895175077069856396581431010089560310220569586405555943516566826296883313621530058453432493678263572953616516188296599122529247873256662631383047890964869958385745230279579365701745711502015371469248656753191983941919350575235704519181924984318126990251158009798484424895447847617497382918230762347208503470946544798172783485666145685927314281891845832830000435402084717959400512919598294887562154560613495266222090675564870549740077350948526326818192329866815528860000638185496541624366437841992865272583470195310895986696858478337206226013899906007732616383538043998829272943440498939976881121384845443538486215618123178094723301175001716111543064806150741082099890016004345469117996420197956356460186933366647707969198145042883655307787976619668194098860339649716665976578742068886562943097355515230402641498405257531101389585710462650910707412109055513612232027212145467440949188340012446031056452371800449414059635524206573205469232419602813635910605999975719194118912443125793145771175617139231891734230401621375526786375283622705224888393262646191710940702675918723504360335547167476237333926171106657513281441062793180191478503414345965458455274740060375409771739814648957310135009872399395673432792138676265984330207910481333702240286518851865493699965486405633790806105081975534390510572966949179713091770960096477267742121284036835389466378119589245070847135114974748211711074826374747108294341287602436741781271722471679063786663662423413038794336391685379992382441863957056714199409814153031561980424561268774639438939879136463869482727700487051883637831597117898351563239866798125897841443941996273554378022981597773718682231876255121779296433007611971826608886629350616500911092126127589418115670127953628769240610853131164073295881930815426048308721404924030638893621713935106694014046162519814955555709912812358620921851144998150183443905145995941403143270606680466578340908825194301037881668050361951448561246593985028454286437269731159576392310763294945369999590621285245633336061964874305116308870408465736900966608920799890941496444756267143823397407682394712756211011602205860303563889338521920211465606464060153718484408623227420597416793144641244968191005238127525974592012262484581642217032405984006740227926708699280596592663061896872214918582868743020089859225196042500238734709777141882909080393553526593513452859305177616098821913394415460068531161322860643209279146616591945204631335610548918526264973262803958655445188806497316792766611330132721741017225333550525590849618257851193119631902875338951945130323145193127763405738402325415772188223243070990017681854963163751771716807694601600631999653406258271653143350129834423763542133621919120708506150740852305133584918902710218347611439979067323300858615660597724735988289123492161069027418706817595902989973902491525913636711267072144485193603270560708344166453511245224774860703682914901313502522589580732991300316973392362490492794584241749793105242167825489171715706201496488121606248087947734674569451879215560196935715763049033570662930769689786730594207785938601746825163572966209359957440149163668263017557978699173263942904145190831300996546651455179869796791577505449673058583460207577523318795119727946190223621283653830259575726315812082461687888404581029510573721980285315121182774736780542522667645083679430487446222498916596688125159656983455263304586370172769414158771602264443213498120838974964764088323330796448321015565234182928226502744930992683685591544819044563274701609927342780651015499993544288449336531076710431538443489378798766261814208850685507488018830003049793836043059905274675685014302832430660965344412493359458304848060698952046001569319459483363276224881180789193929043368245100395653323145351477833472353683978251661305301037752587787305889298962741979198307824988871640572432741347137047445416350264112515111154077649165954886689385404803617917806729367595709715897522323177503949297382758152510043825657785871239208716963274840301404623802846994409588080623456274608634535789125981248591668841425291922979759888401979297117478880948746076039503604188953959933472189140074172100254335483872741657554500010492330211760750671018203856656538139909933571170291716121341778032804362740080263456922907931052429865727794880437831409948277066990174834205232478319384483718960317701675739591784293294160762829298527116199736876669074132519597976815222001795160968736084667312771908679057060611713763311899957526486731731884431568096568745972241901508821814160287701427016159902248138658279451854926112856866437861686305801372865249517143952047673532831914406975922633431329213780887314857084053841468619786539655667055693954244511727302339243237207913325594619128563009215047594645932896469858458753735993895114843752045409142032323220112090295069855607993409577388809444808546117928554788725980157848842481329945932503065574485518522238234351015839200817583750522763624368206332079700824774033088631856409003001169225756081704313584621201259903522277459467363625015928391859129749544230980214293076266309948237299635740112552585450077136783624933351129288267906550976897863893110566018307332537006913784372896674037175606066229108655590453073421997419555557341976245552658077746961011424247665590318730054112885564862454173278268262955111270430773656320286771596224506187237995866923973593343268254957012219939491186540375587801512711209205009891684490852294519779725111937434069191636041861998942872389836625398678713852068356262854192174180496635182374883048469739100140429048975320232256829860722829353357232260558066200316346602112470213016486122761151524168752536292446686083491035558437040941953869633421846851273375780357312571100222273569041417302423180173757811290910566773817197389696625598159674288430779566542414512915342928800792797862243785643805715820898342743503714857956510216211153990832395566365890578379672305351587835690070941691998517892990134656017848890320190404499191296095053020017727076658838285200935964285485181371245442311074524902343517614683763639588444198957294854704475598429059740928109530226394514671584719008526045059540629901871162716006716144117623316516769915046976612228648769755717085263041784793648814353407179826338764972340246100136428411908510359005602164516709555619913207472729303281189131653836817553595895300174918987728235189154323229673747023083542548770567176848435540833562409178100421565667946221456013549718991818657862656373466893987591947482101335686134284591221674012016090798288852980187582327417816828834993288376005835240177800102686272667240427051190365422177571238761336348161575852820902818357622434663112271776622019916456269215957741986041081868780724617319854867466793903979633176373486704681324062737895848066976494305976622192014362037501566624408688575798422589404774161766468673174317773848673620362984983104334714415533333508640467350857830370968510163589966559046813860649762119734737766614393258686897278920658811191172396854400317412388283992528801680490149607737005331338445446186302842069222408847868786882915289112080352744023797679685574855488952462452647571495677158571259382825772565886418993415598149460667003487506672303499043089191441599008761015871913043398049333161425506288129213151279676378051036811636179276909536173101795391885745385398624609769320043989580251964686862149339072476380130539430397579350831084711663118497514203032051874139679066543826912248266304265857324594009991243046232326987521454020571627087654081609104366852755382710356456267981205441889859577490598768257089102364305315087488429964360462190558210411710671618662617828204369217857686594493416123335886498142226277023214763635321000633368716829896495338119970932069964051476142652488027100652198139351843701519119056852419073737310077460418203919239175755340609688133006242093317668181554745577648758076801966997937171028390046836884981358013684120593478841746029634531304852267504202213044941386507224267321241694338658419533974820629782970084397644962780437487575918041234498292864051925956107077884746565038455660375510270221796391255104450007314683943808915144790103324443623140620074056350803425691744697463299794615898945065284142593527725706021778260533818690575065579211853346233506908558350529970086184399352793338743830031364141688678991657600886838157303908247849115849239671562197053542893249064529901657626496781082611135505535861058812723126482878344195355504029573502155792449160421416722687628258335354513898224924358773032035920899213184969483251636028985899652832282220391081387208110774417340318071469462135460303372277704725710876312238824707756547138855503761992188378189272090352919130417342612051988841497387416588275711197548512772114065184522886933118720787991203910015210857242100932872070093999660603528566412870878603621507205239886159605119142135474785500863744323655004246096890713358062011570382959098776980930428947843230552612738763331089931511414818875440262027357766828528298345223553514234071872172937774285497601355135954362669989925074191986921790089580385008147781465820627041826567923630706846900279213393090407810690285578096751821461361774708658242628255478504631502512015585108910718474483997807931293699052699786496965710021564317177485276786604805096882125944881058770460809067674885883800411845451587098080899202493581744965885156538740058588950900019352267183856215778557849886204797053581216702524528189678209260941009054388990249830362596167694231130864431155451396738505179383789213707223337986465696198154653854805106779857764390418028479457210839273210257024759970583474843862820045394375051455242170609002963536077801558199220974978566485165009001588721096776590515244111723556291202535957307745385744447780940468009546587589320741436077441561894102709340270528303433236650825188557452745868378103189648536312463274066881799077740934910070880800711019779782733624705804655039231137082419599613601495093912153779644936826671808894439290873390831927473016259145173955928947331498933741589739164694373452684313926271842371783384559353073670539869005238859590854898224987170264561348415795357619426637943809433167465159370928455727249026709538318539780708584957276754266597937087263368293578182284406805261137718787515224463366734172174457177470846324884978907854497838803650193074672309641669473256620466963589946151595427222917848355345214026230442608530561091539819286000094869491928332891576131206369128819857580017401768093134841822614253942685337390912063095153996520411254794601301638019271381306040994990665823166176191640465747901832721594390862249914568028471626274910607900139737628548332126467466505611047105934625717473935972369175074462325842018316368447438590038482383462916853251468303250034607363204229074957346149992221576172417467729662241022601272921466616339444930037596367353792005814520575693761601546748408276133695825131903750621247091586805287709997632115365428797602186643001713527081713579285749583317874223481455965645840517971002548110987708232439979533186319261940332481315979241709111585313129290501691796435523091179701160932051444319211602349166862132166260790170055123087648604848168651893406570896696714252685753454631585389339471939496386749454392539650616681889641652420604476144652747460181918727436735898090767501077806255481194372804620491476613694591109664466050520521974902243521022842167985918575158982069022231561593757035711773292691698345010618046394713215733061507458503393726246952171969080191483605950726032519494960579245874553687404422659057871534703323302575467394168518377984380377847491233500797356739150240185099495495002727801985022857730402585678501233562728050479364977939497559995502756941189366121779670538986196217856815187959655757975963767940056845841673610931254508481764011317827036203942860689714539595002911774428290028636853218115137312256579566243425684005469828387631814058456331415086103245647058302700866584573933045597474696798351985777758811457558108431499384363263366100513444443755935300737887205537537872800932759910597569832644704434137031436802227259992098267768516332851437302583995934393218193343844972063753906106898371611843216627168515016783898678029933916539957233078002578108684061193270380488691500093833768887515997735217050449224569312984247649631877250038626622274352428840535809318479804456214629280215135876718451902983965550315493688105480252793408387733631131097597975915550606787302150869948577276214914888256193926913417229998841875996515887728593702506710448613778444537922405258006887104174529935383950476546140519221965989178352452799741216875775273464350974555947432325460588389938572623031008656019100702302265300714628938849478559147869763583818006259637672585283071490871872089156567228140336683052122522635887953938181574410215340256354676643937426930104552525997114258436605734545685598347270629965119992617153265057184773486356997587491166376883040536228553887609614150405626027837705386508969580108121836397957695433381263237685883565638480737820792750902501733569964361266909035867731895809166364264598818491748160831597929906033601210736449384325814504262665960502952650025527213465589685776238072904188555594972154044438764353768006183542807243281236919112401013812610326652729685468237635829910320918706607664222242585745811091675984863273911319977361327120707645280631401934524815785167957735721065659677229576457223942994730881634941371581904254288479482744912289257184319594492219702130441783857578301745434874496874879099158002301379274069934973500143010979980912083749705101872533758784752357339051548450723697553978679690669335364174776057413060863494890176080783522910619012496073342474109034409492971556772225519153715772989245147145134436627408174141255411663988591458587824113501231418708973557627337583341483899602594125130112223587342031891919091178297964521041343140988703462987814905878767579310260669147222717422268083499489892723064367916491693678450732270562727634742372268061457820160115914157825729371366791422291680365053380462847140499906539048175582000481384582092366841544610207723496193902020806651795394129842569372444798480729329307822655332519355990390085249304553552659337618993366526754044781783937858913874352344436865004191304714268283801469084500094002737096876953863355380319581689775496986369397057272261547293386246668239511058743977938099934335050959092330031727315718671464201581791547195923632926643525962329230398871539868045412727056802593534391006623004546366983904308259705742215551025097615448445875583907628342881267398128470487346237939347554057868973354434600404478370321057249630743822133478473248813050659503741638602180591765136957410150233031790539798224208594728457836542341360932808661843608542249737981797024764261430664836975483205312957322867316984609574393525743774324194550064773685930111075656247047993245003558186077225109481810337338984748864325236250116302947566141402041039693140465622017922322453853362177640140272606810645313253081928381525884326718148563395672002716535928858133732628741876271433174610333931892399452178307858487908440774026937739509581099522152673023968708183195697324235468913168808819124028252328186525136408815630168589988373219145176123026529900820260589325771086757904241065560803584740376054053549040657524075304527336471493814560522613702168204738928694495944986506581029897478491605273141680245834660607498302120349430891191633309539429778982767268071647995786215941369862825134414166650829969352661710590707960924490811124872541392845121151771315128944737202454261365049163387099979944478822572193597484893264294785309748883221414315194685585060132452832399274279292288582329279839390553939966815894427658180825993935956278479712871381340921992728904178624328547756394799662183741530526118072509897782689033371890566566548784131630527202647407999306764358681827928487313674131713385434586881723396798642587184434395374147071259990437826675897573489158819429542427740585097649247173833732349726857874389213865820269015243398571021762328953185092470465512414700578176280792412753572334659129235378665943704161786448307668404077837765516792105169174258339379602156190768408973208254505093910542348729579130079536924050373095189096892293877443521177272355597170704697770513557931372084500808197059001475255378372172390081904385344658031841534240886377565351428629614543771174511290920288273742947921287580988674619299585061782188357934863836564889768950492170450479575478126767768365064122559064350591587095662338221981266624106504413040426543089957515796770651250223333602046912888877102371203017522325604064423882029396032976271682641299537401179962979928459322986623571738233048676388501549213322518709775487262549839738927606857368350864770128728257552541670563514126083083367613015249830316877426661205566742283390864840760324853725406932553766776730154206498041004448580061056095396787424768720754456888062189343827463046253728616189158260923663174546216602844734644460552871007282370742668388565782385400321294508762989874937391774581349844537948013389936768462390606472824076985739697430301574192071869627835677497954294350855883649822319667851887715624381876421309408901325358505301241716502800767536891717722139814460117406138496283877033829106445623751029211167247806672160767768432507931536302501453489367880091490291940507421011828030800405967944115196454316519917912909082458502016830057667490232777275394106218414235737277458344449942577629987987575173321340621658161872256226563051259532155304688991294994937816688602755105728551741001957090778974307221281155809891039096626744921753946452022331597323794902340480248935100172031550120044785772016685341657182147788095168875730254466174999331142744572544471088844469756711703370981627357198861451380557284496240184759495753802981966223940136806102529159908786983083301336090770312129106857143222798541083819851661499392379101367073120631059230481194749835776317186874660704742050462368427955670900001965445637280484883718359237034060883649461408215531933244837724085822356253328708238079389430976574142911972638218907380265812934084476402749710789464529732733229849012119618855250266028596845805633229049451623922107881100647953165849958121920723369496376189311426564577646170830026517731959576833203682978666079532084145611856850288664988074258614960685897251083732611698507299810070854864989590432769351494262471771566312174014651165755573915177253207250331864062790912395079912538568059317334062598145035553126310122941993191855496311663023067121757063145284576819193057974693553780391993177797730526291104158594008595853323965954698872804048359457648769849234241441352168168082324130108614893741764181443083936783722217491678896242128384141170490767561995160411795959423745141933486954523442405271485648672794628231774468979872153497582900586556050236364434267196394919792375416023302169235151014191429129374760542956498763388794997388669154765189369030032474055348220659500993418231147644724894434588669040109496152824816930925311714330610203963876139915645347157213468846384912060176320216105644263580203471908717199070161951530044215819529220645485148045972320392813261058910519151900229465570598385034703583401771099623504716754404244306844771747211230966440668644951567533195538572324471435381941371921822597623071786087041156902668817507911779259291206458320578661247987551214300838992438323425597249938831545124521714178143875446767310895231511351858965604572099746428829446826186485806861185210295036379150731218462132757191339125090461997127754816484368497968323896502790635490289873570155483983885958417580243045225489144827794819315229633029165926575537851759488801189292310554487630827710606061369294372289076331410267001243152950625521868782078962266247596528764177737418651342159971878359476585079644543788763063896838849433867998408983726015254648636212127566266993165654063818047757099223931169396724278301298610250680823883539518050940681865762759793610317096162496854563287269711926207935028394422386064661894628117641488725917303689356829898310483134501573058812104539530055618680520558179521240131735709179682636826985511929422792465111074837192604563438486993774050511826246280615723696111486551180829618205265250376828091911581476477847177303797989301516724893535586204487610142609654827012066231298450887110604983039885611014359692473603905405467400376692470459740627377003215234115184349078109046335269539435293926197849341997559918665573260677661947006169682807659024363341127962097819161579089086103836577182607749496243161371419935008822637137671947526082396093630128583890844223072195371489336987128642663551511987985364024624293080732314982004141877087475004606462541009411130988158104981243756667333131391659808630749526218179376029343318792115126411173541913017158410572651048235488377977866665521542522772103217290027598805365653929377158688649897404153391780473233151223802525661104196715910898583635521032556539580158755789670152914786283031864408072513779848669052571086650718081560917762973360043589938531229233938057226885327894732112966049979338084479073854626861766021909959056375013482488170403767722739684854745593812117158988852487231093916247343166135888837147809157377209097041251733787725801381896594952114651277772061431854093273111103818475587571776523183215897307183293962492370216708830209663003411706133970680162115695567410938117387791758974998339464546204365592548425116264729118413472463922171275691957209005966131204064878417626580006604154809367605026833127037525333985944808132092749110918577907369077903250953866116569903796001234537711202620315926542709395940388824939960905267389200813754363055851671941011257101438362111937108314818971279442145882002640739796601935345237768756159757054853800697424603208633302508919723987172629528208006667644485799081389373672289423731465992930955814757556346840886760532455931020876236066838283984366956514471563469320169181073520318693625867852667073406126777394910847289385134902221220213705841773720978285707552835777443771531262104835741735259269884648145261593040585244844818072029878865152179452417719399596774023376139486918355754089591160917419747702886476446912719856942096480142139870422469917848169029213171901366650725629646392669032304630599593261290336360867293361461299063507458936520081741370435505066503126680971812850317697538690477895097884953383430277682123045178784301259534528709836478322778859352252674368945373462577161215376312004529357945345973262022096714236150507245110107298691970165051044617582511208207929162742229557060620868318395126162353548780286461045082174532074301815625527762947816014021772876462443979921996786690249787859290247548003208371150556021143617928124234268760303588821034186434593872105776493067568253029709804419525897484269628442154950012315337103087443985017522935002413102808834886557343056501269149955698607245037771845316280567206773098561874560342392543470503047318234453949424148938923291207530872219332875173797601086156490150444830381167909383876899416275367064865076717310653875459432625804714868573341971033673311269447989623019266729654195972342382090775998881112978800626440639508739708556661414829967512089724545514551247975727214859640943813289853824271777905185103354455653830128469323800173836067041286822362866584269280213175144644497015625353922453797947863603048159234822661877763237660626508839765427114384629134355762293947600423511819248118430658635121045360787137691563678518560401623011379101772995713148802188265302395546709082384040519613122595044183659662365155838734334768952709438511654595741206021691293093046920612341441085561245936958611756948697409602490950324467179945438769203782934011398394040805858939761725257360256497136349331102777795965143527766225025498975228017569313781342339822597152308452576550954408189031159210712675199021397680604303230251355181030135995275790082314853514681558834373277876703423462424144940510532921114566530815746396045598811553896740767840140576302281452473652059766077647725042138843055590055505389734502502628563742166600143203967809477558292303459217609297701857973065385721905835249589122888561526090475634175572221066011030341422794965937453900395424838592167338867595091784865363121057313288150976592864619174793105740970295489094339493570636618816862520164785629299910332528644159711890548090983657859370469682445482703002514687743678846731370466861104507468296963744639862085721615001393558817793561785897634551779270925906036821607393382864355604342262880029309441804260911302275626652618947738716951161869695452967894517679338865688756406205700539708860387779442367990998578196441756740773831535410756700881022537280202013705382031133161242624193694873762018610760072588463458263651430684488738713666592190779881992836079007032755891567500181979322729229185697392557698886806376945945490349664420735079926906229633160806054934108830454966065753525034471914368262994046414971687766739702046043505353720748891041891733101693665558790770088707123608470660573327783656974894029417633613143692158722070187143127353062965132951773541766943940209655201541642231808271588532055183267718504797512864485087260693636107061259391488173017624035396633139740677674906019938114713570479425052809441860912309725932944255065382500657082284419015553818210495637709646885477771783599007375249245337018108342649237270961094727791698156911541552416768628526673040591620664273361369187399272855744091950530509664686662321597893006335284147811267898651409475690128911128662381624156838129746510658647296099337407251985843011669393107275557895597373383492335680698457954216229169573798404581701587417522801597511099139886356426426511210878707258011236418824501887364693433102164369132820735811665239253641072595793741587265096275088354050769151445383487992931671122782339129710558721903610255402649975195424501116820960590019740177887673281442874799506445283870378940669030655537683250902395158525349376228575810673919190781884134953339304052765400806544269842966594806824044233004328142216206755042860639161418307126116600240132259587132152388614407032270139229702982445289968192571448632941045461669328833410719208560177179963393796873518829061357369886702245826675096726698090241895257876987314040208272224621936896498066615958176829593669467660148710246060529387965338355718035719879371270677475591937594782437134585047826623397251977405133276966107974802268170704830083784464137591521869710751888043962801371476585097649090921970675451106159100183873759962619653582322836281628559101721867066682668691915217211900219625142537748051788424995868336880052121472922628603587786353129347961679126410830176210469110596193829322656304638648640137021652581402460730621023779022459951467715312397572850916211242776740752602630316999925797659193771546812148150805884796644177691179968792539571182733380976527559335407210724930615828936646592823486194197511608142821735740825511678912844147809683635497533345548233971243654282092684488964278395434241875510384732099354344094635271579885366927817192919049823094364748377791533034549688215328926167453044641922249151964505662412775619406550572129823457925058677949868461979883861802778690296404556024160380233334698874446305246288118245796757381662397564772187265987508871257998416170477292626340236407788873094584730717648073671896879057639812009745310006510771709080710997922911958274759370840317685547177112658418529838964249556823368823714848425196183453249493433410200668598023473996015300558062427758402534724873464856501769071266809746327519629909418931977986289369871916961242931166992470960231320731846851828091228106499064389802478308132316334511637288408258530828849323246185126329256857918412988466899499403822756934558889204524141196507786603242420322521577536095109024727380680566945134810063370243609386160934776478518720929847275344366886928811742745144099061367456227877663670447508542119321416446615600266071430372237215853381368549482788884874115104021088182339374684233451207328036282034266457132293756256806017538857877346745493868224984952226974696232576912660619832703624943929383548164689937440935181736498064446281582096723739592693735815752335697090111480946061599057364847358850991808796380645133957992140184195770058781533131470324632981112505813709266915342642291587836335885646499472915399511494941255438336798452981356216866941945420182709568722786363866309919335803736409602659092590851122089766029425406868407979048848643139535479621525074116489767040469398306308933357659411733261092558100420428097940352020681411674076253248164038770925167320641524967556445223128514193669264150712159525322722175146284982316143579281852290383719228677732404085015618820772309281328549711912332405372761346415953569018378458713412749588612943863140972035107424314280376739741021421969639183088995895688999276510971661778501003383694017851894693913391881921842165439741986684519587607592467064660408446353689767501623042035329424888981577582386178979939479749295290081763747799196589600727294816746109397709310690314290289268497963893651772907890497625181244692391099639277592989247664435095035570239829132889819434351178097228987205922007590441859138434649871189790918710291094232441582858445437710953137769702478200531075502310702219274324249640582800817812426577096315533231868623019036405803121787539205912162111055380175828159859901563488901629959569432642980639617134171862696408300441296237207592635055455006367843712145278389723393006321845762310164716079893717349945980456390135358862380453473493994245558434104094476154806347933471932483822073360728529410437888239653862807816135743804223750772756451628207795181036943921144018053592995598421886645719813592824687964531272232087342591140639418862562045156294629853976387022622585077167009465777258292288635878650582018829541860319206717661354149322305374163307656617037677256193751717022614769994048016552533406984688111995766021110275711790846221971409524217576600209981071357922644792633096157479629859065348800766856297235407244284704030032521194259033951787610362114322896027796898060699458515870666159883695909829443686132537340668543619011507725072997172143717960015377185561142743168939932531615694493544239046402527586560111291866467902133263210543142706817941200924539829626766105476886504234460158271887877756567246078451179436435243274510424598936332363610887718379723625012139646549680239707757716897727642732760936572301691287036198977505491823861335877678953266683062970198227604508422878218094170273169863297849196083453438487368134183082924888568827528337511993593750518721746138920278833369777699317572612771535111912462853166959269062187213399178979974111541534740332364393499918948767997328655081686879249611967147425012427374455006218770511707820998908466821486000836120059418493315943434951240776169604915924331983302325114929430116988217409120872376770219599881357227124774313476389765098456890431162276811874026444021478473503495618545201952933461915725103303044876966330653651179870567005863400356519095575815576652551336221897173408662315255503986735060620275436836351715603069105139067435419308255779716355619265602941657488816327294816713857053190573760707388316594065102526094076213800394619843180015512139011044867053092907621758910307485604182438910349092909342332383950972964943076120539530456535853289044936544118933531207083977622000844535665312392959959727006629889784688910561852893524660374256923023577571597285102683331674004053841617004074187533404026227779854639671826251644178880607028249340964351912417918274496398998482864464306144822569390477373662964409930272086417377598695068648579533054848515319822896165552141294586344292573089839417889244504869015516380681435519862181147003680492123133559242070773223976579666338243521345105593759212845535001287543872666751090348333376760135520603816522259229440951066365554283716655299842237352542925488498684119935562230338109539563366358397538362511709256401472377059182818593501721327239228451695222295786748370200269197380470621807212350800755897307792423721314569542137025968934998101098432011468912400911960881848375403251965465325868734202433450862441155996553575959183632407290372334710702033738645190673754091887197859076258862417529471223181918228225897297724737817645562950330564743196941815131672494815322988752650598479087025111597243838839631706472071908493685657387519519488240166181249146905045134256461717202755855826563385508170469466154017276503803645645550351044356250349510505216116795376692672039474173006979084497701583478739253002624605490039633446198891575856841026407943033190788310083600678207430046245848298955803591701915258211485569596509843077437206796892435775227081252625257490259643265513837137396320412246546762547042071756935292026183834705578277683553539571184521595061041700329066236529894050229234270316017346271650029617812634709472475350746022740447380362060821712827402908452806671361334018800410904404795574694058942002842128883817319443709984648813477928138689753686597658486539146813997697652421839968295983446592222296041305360086263956704012625630043852079682291723374314357325338708973618875184150000905651195839716862051180667898819826942643216978488376337650683999694233247369106461333061951911340323396305397788899566416474998819610191003167090086410873875067037013993482072336002891410665440874042374575864956769622163749793836857103728296168269828520295195836173918602043924756333111928507552136790538022593940343850430426226636090605836318551235884357259989855226983410136016106273467412358310902859395534203500382659707652215835105486506838841661249957030039659974154118616375322864480607978994693253883321605366941373116977222122980560524440021450043119057285163573114720054007195115588902414315207758641584062487146073380411849816984287982040364268540540282813562319901577534713405493764437569915199691244172719566956390625676973623115395510536008984041780927135920060203884718937808433403953622097576795304594825210393555147002683895312193303656330303489428871649048302470544401697619613750178071262949532668342907623574997231229541965616906240000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000");
		Rational geometricMean = product.pow(new Rational(1, 4000));
		System.out.println("geometricMean="+geometricMean.toStringExponent(47));
		Rational geometricMeanPow4000 = geometricMean.pow(4000);
		System.out.println("geometricMean^4000="+geometricMeanPow4000);
		Rational backToGeometricMean = geometricMeanPow4000.pow(new Rational(1, 4000));
		System.out.println("backToGeometricMean="+backToGeometricMean);
	}
	
	@Ignore("TODO - currently experimental")
	@Test
	public void testPowRationalV2() {
		// From: testProductWithLotsOfSamplesV5
		Rational product = new Rational("526462310081612344379583287787337257138523474588510749930769259095446904499207192521721203413103577641162313595332589948471818668714361796466170201748531737892666307397273677255108469972899280810315512068810770043846529949588235030419314756228359837161851181041553423103999714208508722179445442415630703762397640263829837976735021755937444922337193252186736443289782030091415744419085142088406297795973285776381237419195516684974787624804681378582604703224048379183491139240139252142406733623558784194201176961133229848322815270885840237212077984870897924360835078389818230901531931212408438705985035530456193360515793089428021330220316269008477228886270739352657962167940655420122125398988699976088050425780033534641611100815507051882709778202302601480170880533185938071764569526102452234814304584560133303940758500753584772839316142886318038523031390524667630031686883113577195905771807276982556638423166435800628720483989556878400245000342955051566446381660896858154596528540521879620601919816712725454383390868083845152553009693929890824584779501306301469505608663805142752359540418070635019756149074549371642600213470267804509024916184507793174066368793356491225208230297955110056570350583594762363385171248748914501726277301795386064296594661856437498133560095246595518761262173758566785735568578630699785609201752604373990229296613682438651704219768037119009185546963700197900940645027340943607625722357181560618732002097395608560577906448051855156543076367256544254760417082246572679762283342884880344028171666221411066176397658168146742086688616871223576671154812570196027833390932686011245192437707603685189330650393899387427870553240821350523002159143678364172394042098579317487064114783902645927919979685174930912637737998038297861559282726240859034804121814645430186191350633825334133799321458843784123624915281277684777532387938919932073133215381752812876939074765007728670825894039281359716901957213008667662902807208292657957906203242978852889537703394123112995706722292277642923999401241649478478880969991820953681358516262941847305076589155164861827922982647542992065189260601198213288462365843009668117925650795207560191516900862607937165365622889367538899983042198322420165580094752697182561814347921587150722564961846535458954830523475926390415485342283987767209125370623520362416679489500020348526194281017289776464005535224357394370617645548944545886483883696618933516277242732909655372170828943950070150129036447533816327692833540211634192980289670385469194853209336112849476685380286719486734286455823822340217103725424126276070738407934411188031650803878456334778729585019036936665688990515572700548227682212376182304396680105203006930673896838812833014157679041932225400609192173134831587844267671068238660918398144147042288581953640767848361084109995953213924879650824113277489724049515219744751308707170174843530257246759225164091557650116688588680133083411716865057651656657965559095292923447758342660292497077273246838427522120341195873042446510875440872276848431699559203476129246708031894114455581301376585471426566751159124169033197662847608141991407550848461911065534116718448156226072217788607422200372165981316819841898086399667077117519710105283933447547290990725971577165600529599256381989086059499308676709353154323215492324652843748911186409932400324216225496098566288892984830213125512789682060192805746193045027858590005362004135639710543886626133414378343954150131595827853444811143045725891788888653875908918314782947823573090016216596609324029560455920154896456858753834763001466585946576947321671977238384508728196851331737221246184668530718316104272761250810311397877561717938856535995940869006220319240319447401802030571336666900703060861134739287432993892475961208261257196552213984269081543992257171828605567816046146602784262921404504232701434497561011620192594470455625914931241907267081789107362946608439124576918620048549729724848868435599417023862302760743108922978280927550643880825831198699605057853741890833453585558750225371904163583693244150334193495482691452931161899825375945348672608658503806097030400254583418116430200822681625417273844418730992685418768503404843386360332375651348681709691920165067303571976435165667876309408939315571253758054040397802472964916701994377701487923899529153625351454398790088392206983558319236475470680744407048493710688316943461126089085516515836205783068317600855100384923607337248944221795023264357615424639345349842462154586292771680514063820894014205790847551650347319437562450978085611231094903041914828661979371524684047366280333888551998648990440099672559448289110003553659944508021231553940462646648481622726667426021753374093286265603615574832793271485079985418379660816616217912093352310313587873654006933815983857640235910653645544388352848148206597197474547441450509345210151370516848721929621313962045743664156055676032616112591966419646442058318558205500031128572383080603241755893383298447742532126732346942290311484336465260338119172554749138107445434496940169223421433593071417027787529053013953133943316454371018812276719566825419901910193347709642098115424359146569049485763001148391491817884280531792141776500703426936426993992215760095475283839556634432914382294175078603310967938524312549067218526421287112094466674988252264706958481146171368224525351784202852737063570999579123057166531819973942135637966065895758019749009469036990113588123717663740737138481788175234321392813081086864581949511637349700886214960952271813299710333568975266318879521179530787413706934087564022563895724830490086649891810822469914672183733735439053417081899473793642577374713537913788687401305860580792023195219985907193192845660400822857392621243884357586921515324337671038838046266410409900457652594430572679531921054285602933385302496312090830208833358913492258443266461784269956630819870388745666631984028813183112319314873527796238477947778030819343447570384981869027369147891646899773464631850473928801156771116059043185220934480257774980390299788482741327977690070975488813169030139271857816784270223871740724246607325426096119503091722184432226692785707504069133866466962913174601823464349431191785130030150796059473536329838614321714127735650141999035950277538245081584535773183073361649967127548715868045830920316293125811088721212446217952275594634435415732632650486040762336689854619832324725037766879094851766459502590489338278381082209161097681905755934591601282293209454745533175103331919716692682823152535743796999205607550539413892033874733021330268465707182117396721256846925644312616687697316677489966690534822528786864695959738063278189068654405620031851947779684334566435927816058631531401822113314328069213464107438748459467567042206833938286578685715311045328245078473066411852962495538570783002271501191334489626319800314686664744981133408106054854058609227325636355034784144843383819889692315239514550857924033664835969211087707089035551225092739873180654862394802017902592433386087175846509533403701111555485966490830268386638966691304382611187607464166739569936975438390874380123534975375403093907224983305672734700703829153999598137926490097455722404256887654250629512104452859422444744040982443627336493863123812552090293832642637248581797434071755194451222388617497294919504267299845339803125431497449391406447990468414420687620382258034223569026742438721932495543404601959519521466210057868652142748540238448713919587918568969884725292678410999340527506900373659967646018124012872654163972271551135143516844201201259364077972728283603893244765533288726515868809497613456036811387583221368604356819701178693229590089565057820715120960082396557459377839625929471978983965704373135651985353265577798124158448350080938801074115843646184629959141753865408288931042027711011914134219965299683871036236192995998458026837066788004663345298857610536325109251571790182555999075626856509538308461826836936900553501178574218825815385749101605566568429196827204602318349368273912269521634353626008365348836362321736366542586516351486792509040069132058063232605714234186488276972128166953481668586448429109229120795063439797833596166913416328631885125681630286397242377677808171607638122388446853904986410763375861793443396317816114675736833258551945284942160392696158154049793378827633740254298460651409638661651611712535924618856653792809912069397586107384506238122450261403002742120251551371959375010563710937880642030127597104883752505060432023242902785736832974782264685508882466274488370839677977991400414986664096313744403069620313881859795790670843709585791701632999007930586622094564916535968124739750927078822264160306740924394600888442436064405700689523322470189829184250661223798144551383635085630046769525187469442511041540250671073491077771704138177562719864321359868996229535314579033839178981066530346391906983234863274991730614272298286521793318571185493694335799977050969537638144136621121570798103435195454840384751612799525635461366961712237798808670301342581787139805221585489981742268069892845106736464295945782364555318774437235827784549290568723934490848239403767023108766793078221460820400546655064690854979175414083006886934207804562720690614442704804780663770003399061054963425914176570048527171478323537813388338030630752948134588615674026091013848066220200162978563200828924201343325649591114808333887587084725951578452235977286807141016061044786496487852782601044022156976493558909357489931744177047085907106713174492838845291649217396464070175076176400528060171510544519332425066906050118803845025726910981117411603090717496093055518432563695234047013731430214804580650977747301719322074823793122058911148659680196134370078298387445944256398086511597577103800797082386702459905457170185172400831992455862284689946247398573931410212082165475177178538217361525621961642429665095921011757144983491361434391992342120551484490484506466056957558015835561617770162671943479762415735714705135770913759726404323748720492507047396631306091587120681766906207549217881147811759463940559592937518505047371009294534437447881055035720347383741099498253091942370266346066173478593602263768820899525128477592230809451825762046911711464271994641435005174742267923201461326818700644918161763389783035230665222488175248958585453358693885151968111919349238742424206119406272488441057456732481357148064949644063514549777180233346671988933875283858811053540471298631389193933002074310023854392884035955009487392332136465404382806676659187140385543374690236239407558053141119695100683650946119384716673070599857692328090398195654657683901687116464574636845373276441935230246210045594650366412539921716754317361441501616860858061727638266802180416938019981536431171754534129027457812146303081752751781376866910736276604813880300425463146313584996378860032198511912903437250868591725922538404350018427526366124261405320032413626684081067867243810308481114768842845333245920723131394647524906462455050770159998730770173931601962200620790148560114602106784544108108244603087499551773535925527028752960643803799444583513212115952657340207030829305516501079449938663836945523193560434941845870513890331404362073022176198428267049250154363489846748592836941101975023894234964865236918811602676640413235310164840644827558695016914152508811311011135130414041358583976183414211300915402060344597234260249737022976710608236887131239123520856489409196969700062603787689898834703619933793269873884356772930576394573957829122552295433951178068475682207941615990113040681848992436589817111679017681010330449008153956244470944459876522908459279597681857892398712618368347218522036449590579642068879650029354586373503250256997608120077973406896928215705230880208499515559176067070820566379419923837592695029897215298853913223659715039935596628658495908367033618758358506490681486005774110025131978282400827024450103738472044577521155152129091990839088740345505432334770828566502787193198508531479665406812601718921875695173336317088108193179433368945147654476851534505403776892367184984237226458556445261714522799375597105348044227338870785605653322102229255346458066803692542452020539617705190806808576650864864969606034964957991346444146467442250823489057286325678635007533973330148523396064101694383240061876239928033619108979227358803143540091360047312689611197731701676819616429619745758057926651989151439862275104221160550655362174119222460740548592922606768043310461341971659240326419118836779375100803056276120375085916068639449823727895929862335190382926746464815859870502534206529677780177597921382204445774601505898532001653859182689517968854165204751954253163301805938768013513971718657723043818530774473327034238133722408478484030193151285577112611110345391649482510972112433739825042703613393585649567905347103136889486686145168480059464008006493824797190826215494974348878106368102115331965293613536621707718803079185075315080899507080181878963430656868417168119645598491785013521448650178548862163563935926723753271440028966633478236528693141648472521019552447805708259225655606320158257234423059465305083611690465684795167910652138256535009167623405469421265789184149673842122951834312829620398110523814501803922874511660949265919221562664187421738156923132671081416443617914122424460510160552823185314271643424104931551894026319460994393263751272009480033499464683111201219617186609018569534624298021312936103363088139721234221854024039844316177667089488264625231140115733450212217775679209863400737539916130744507567546460164590370839794280639007412026986061699178872143211087750642639943793072197892048175072381191568121114252941866051193834761774943232066631593958205778819371845942867383888353991602881844475555166041063544726320104828897784814463583778522566459127306692761544165182674076447002996829886750860680837185045563088683104789632771305712624612806611654739124659316489613816086388312265158987299831772785474530495879811834086837177206864411916371277382865362619700200738563953612175281370735299136980294489855117166785320952353083611943649011181829926403736041701270644409500507170439895389298501477163233085025664928848663176188038046348133348056872788054981097223176475666196824366520632903068227993646401566728137144932540406531425810477327292387988898703585670405245426915981419608244763793555780404626276465042017036899592377110136372843769850212589449774403195154051533278737950804694955334245096397657831382697464253444297240309381416919991378726337670681111813239354462016473591097527585195330142525715148053726857106075789422767027416369248046397298322491130865926493262433736308294069393396889969675006080154326175705628623448053188167545578522429170399534477436325204862272369058595840233416444014693974809461942010150636997859399607101463553035749932726305571167255554504120847360252393690029149206617506737855725523700434298283498761606554380879840329486092398797397031004552778427334210073941436661805192708135604534506867049769979179932909304897707706206776362716134428270991482657037054840269650903015061186839500475704524217504045747638890487311762359492993615436997878480903642075540793561204717006810039539237634799020403729942519383455678299583607366594571458711284376998562278673290769184883800694668090222297170747724006035250301567349524987305282004379872854387581554043511744636532626498571973977091951737807406900408810338311612535037801991771480696221858346814018936526577370372868853737336271350785530004842235168468526720805181839564783727822286356211921872743622319614112077625705140522240877793085873104061588756564602783046063031429042380833597655459303896095858204354630075997187301130664208653809137727218448607187748226046511805673537676900679544555114999635654092207689084073011342800471080764161301145054208816832818193473603946133852346980510923315628198381876132094971896165314132026424151665750304996067272620032299359860339307155800902273089370993221222546271309560213286694850786029291520826091675293792415273352149390372489894373463427318308435284323524227142074812403367721311068694078213856971239236710799663670417356438795772860838321788814627346596749525828951570989210414081049366191044987874450631436239545261525733944722024590253452968360853631138088762288629629190940867864285174346101993296940627794074989840059217136563128326898495938579922590692443526956130690939531499695826508968515209880291213960159947696352545103480808923420318506699436972015381709781630494406060649554483034442587790676833789780328922476008418588650746162458562476973926837556071422919053415608835427421710706884356375994415305620828362797144535988002326300591215691406960404028609738737311698551004462697097986746211534121581152575239812274183598203675153923517079030345292384327672436268683668251634841164115301277889846369741331487678665718415878267688670325586493799884308542003691667126597423735073871806404174832272980074689279901838880575286547520640555738044749869613918685371755839856883812799385178624412789097861224765492937389609941651076334031901624791517588631595707076751105991874211262758005073594526857164552057682626799859202762739053011223396356730404991215675558576709290126394655620056332029494846447085083828996029456014137045810747000983827768746993345898286871853242777600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000");
		Rational geometricMean = product.pow(new Rational(1, 10000));
		System.out.println("geometricMean="+geometricMean);
		Rational geometricMeanPow10000 = geometricMean.pow(10000);
		System.out.println("geometricMean^10000="+geometricMeanPow10000);
		Rational backToGeometricMean = geometricMeanPow10000.pow(new Rational(1, 10000));
		System.out.println("backToGeometricMean="+backToGeometricMean);
	}
	
	@Test
	public void testEquality() {
		// long/long ctor
		Assert.assertEquals(new Rational(3, 5),  new Rational(21, 35));
		Assert.assertEquals(new Rational(-3, 5), new Rational(-21, 35));
		Assert.assertEquals(new Rational(3, -5), new Rational(-21, 35));
		Assert.assertEquals(new Rational(-3, 5), new Rational(21, -35));
		Assert.assertEquals(new Rational(3, 5),  new Rational(-21, -35));

		// long ctor
		Assert.assertEquals(new Rational(1),  new Rational(1));
		Assert.assertEquals(new Rational(0),  new Rational(0));
		Assert.assertEquals(new Rational(2),  new Rational(2));
		Assert.assertEquals(new Rational(-1), new Rational(-1));
	}
	
	@Test
	public void testNormalization() {
		Assert.assertEquals("11",  new Rational("11").toString());
		Assert.assertEquals("-11", new Rational("-11").toString());
		Assert.assertEquals("11",  new Rational("+11").toString());

		Assert.assertEquals("3/5",  new Rational("21/35").toString());
		Assert.assertEquals("-3/5", new Rational("-21/35").toString());
		Assert.assertEquals("-3/5", new Rational("21/-35").toString());
		// special, but defined
		Assert.assertEquals("3/5", new Rational("-21/-35").toString());
		
		Assert.assertEquals("3/5", new Rational("+21/35").toString());
		// special, but defined
		Assert.assertEquals("3/5", new Rational("21/+35").toString());
		// special, but defined
		Assert.assertEquals("3/5", new Rational("+21/+35").toString());
	}
	
	@Test
	public void testSpecialFormats() {
		// 1/x
		Assert.assertEquals("1/3",  new Rational("/3").toString());
		Assert.assertEquals("-1/3", new Rational("-/3").toString());
		Assert.assertEquals("-1/3", new Rational("/-3").toString());
		
		// x/1
		Assert.assertEquals("3",  new Rational("3/").toString());
		Assert.assertEquals("-3", new Rational("-3/").toString());
		Assert.assertEquals("-3", new Rational("3/-").toString());
		Assert.assertEquals("3",  new Rational("-3/-").toString());
		
		// special, but defined
		Assert.assertEquals("-1", new Rational("-/").toString());
		Assert.assertEquals("-1", new Rational("/-").toString());
		// even more special, but defined
		Assert.assertEquals("1", new Rational("-/-").toString());

		// "Rational normalization"
		Assert.assertEquals("17/5",  new Rational("3.4").toString());
		Assert.assertEquals("-17/5", new Rational("-3.4").toString());
		Assert.assertEquals("17/5",  new Rational("+3.4").toString());

		// "Rational missing leading/trailing zero"
		Assert.assertEquals("5",     new Rational("5.").toString());
		Assert.assertEquals("-5",    new Rational("-5.").toString());
		Assert.assertEquals("7/10",  new Rational(".7").toString());
		Assert.assertEquals("-7/10", new Rational("-.7").toString());
		
		// special, but defined
		Assert.assertEquals("0", new Rational("-.").toString());
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalFormatPlus() {
		new Rational("+");
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalFormatMinus() {
		new Rational("-");
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalFormatDivide() {
		new Rational("/");
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalFormatPeriod() {
		new Rational(".");
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalFormatEmptyString() {
		new Rational("");
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalFormatEmptyString2() {
		// i.e. should remove white spaces.
		new Rational("   ");
	}
		
	@Test
	public void testLegalRadix() {
		// "Rational radix"
		Assert.assertEquals("3/11",                new Rational("f/37", 0x10).toString());
		Assert.assertEquals("3895/256",            new Rational("f.37", 0x10).toString());
		Assert.assertEquals("-46112938320/279841", new Rational("-dcba.efgh", 23).toString());
		Assert.assertEquals("bad6",                new Rational("1011101011010110", 2).toString(0x10));
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalRadix1() {
		new Rational("101", 1);
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalRadix2() {
		new Rational("101", -1);
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalRadix3() {
		new Rational("101", -2);
	}
	
	@Test(expected = IllegalArgumentException.class)
	public void testIllegalRadix4() {
		(new Rational("33")).toString(1);
	}
	
	@Test(expected = IllegalArgumentException.class)
	public void testIllegalRadix5() {
		(new Rational("33")).toString(0);
	}
	
	@Test(expected = IllegalArgumentException.class)
	public void testIllegalRadix6() {
		(new Rational("33")).toString(-1);
	}
	
	@Test(expected = IllegalArgumentException.class)
	public void testIllegalRadix7() {
		(new Rational("33")).toString(-2);
	}

	@Test(expected = IllegalArgumentException.class)
	public void testIllegalRadix8() {
		(new Rational("33")).toStringDot(4, 1);
	}
	
	@Test(expected = IllegalArgumentException.class)
	public void testIllegalRadix9() {
		(new Rational("33")).toStringDotRelative(4, 1);
	}
	
	@Test(expected = IllegalArgumentException.class)
	public void testIllegalRadix10() {
		(new Rational("33")).toStringExponent(4, 1);
	}
	
	@Test
	public void testSlashAndDot() {
		Assert.assertEquals("5/6",  new Rational("2.5/3").toString());
		Assert.assertEquals("4/7",  new Rational("2/3.5").toString());
		Assert.assertEquals("5/7",  new Rational("2.5/3.5").toString());
		Assert.assertEquals("-5/6", new Rational("-2.5/3").toString());
		Assert.assertEquals("-4/7", new Rational("-2/3.5").toString());
		Assert.assertEquals("-5/7", new Rational("-2.5/3.5").toString());
		Assert.assertEquals("-5/6", new Rational("2.5/-3").toString());
		Assert.assertEquals("-4/7", new Rational("2/-3.5").toString());
		Assert.assertEquals("-5/7", new Rational("2.5/-3.5").toString());
		Assert.assertEquals("5/6",  new Rational("-2.5/-3").toString());
		Assert.assertEquals("4/7",  new Rational("-2/-3.5").toString());
		Assert.assertEquals("5/7",  new Rational("-2.5/-3.5").toString());
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalSigns1() {
		new Rational("+-2/3");
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalSigns2() {
		new Rational("-+2/3");
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalSigns3() {
		new Rational("++2/3");
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalSigns4() {
		new Rational("--2/3");
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalSigns5() {
		new Rational("2-/3");
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalSigns6() {
		new Rational("2+/3");
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalSigns7() {
		new Rational("2.+3");
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalSigns8() {
		new Rational("2.-3");
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalSigns9() {
		new Rational("2.3+");
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalSigns10() {
		new Rational("2.3-");
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalSlashNesting() {
		new Rational("2/3/5");
	}
	
	@Test
	public void testExponentConstruction() {
		// representations with exponent
		Assert.assertEquals("100",   new Rational("1E2").toString());
		Assert.assertEquals("10",    new Rational("1E1").toString());
		Assert.assertEquals("1",     new Rational("1E0").toString());
		Assert.assertEquals("1/10",  new Rational("1E-1").toString());
		Assert.assertEquals("1/100", new Rational("1E-2").toString());
		//
		Assert.assertEquals("-327/5000",           new Rational("-65.4E-3").toString());
		Assert.assertEquals("78962960182680.6000", new Rational("7.89629601826806E13").toStringDot(4));

		// special representations with exponent

		Assert.assertEquals("10", new Rational("1E+1").toString());
		Assert.assertEquals("1",  new Rational("1E+0").toString());
		Assert.assertEquals("1",  new Rational("1E-0").toString());
		Assert.assertEquals("1",  new Rational("1E").toString());
		Assert.assertEquals("1",  new Rational("1E+").toString());
		Assert.assertEquals("1",  new Rational("1E-").toString());

		Assert.assertEquals("770", new Rational("77E+1").toString());
		Assert.assertEquals("77",  new Rational("77E+0").toString());
		Assert.assertEquals("77",  new Rational("77E-0").toString());
		Assert.assertEquals("77",  new Rational("77E").toString());
		Assert.assertEquals("77",  new Rational("77E+").toString());
		Assert.assertEquals("77",  new Rational("77E-").toString());


		Assert.assertEquals("1",   new Rational("+E").toString());
		Assert.assertEquals("10",  new Rational("+E+1").toString());
		Assert.assertEquals("1",   new Rational("+E+0").toString());
		Assert.assertEquals("1",   new Rational("+E-0").toString());
		Assert.assertEquals("1",   new Rational("+E+").toString());
		Assert.assertEquals("1",   new Rational("+E-").toString());
		Assert.assertEquals("-1",  new Rational("-E").toString());
		Assert.assertEquals("-10", new Rational("-E+1").toString());
		Assert.assertEquals("-1",  new Rational("-E+0").toString());
		Assert.assertEquals("-1",  new Rational("-E-0").toString());
		Assert.assertEquals("-1",  new Rational("-E+").toString());
		Assert.assertEquals("-1",  new Rational("-E-").toString());

		Assert.assertEquals("617/2839",   new Rational("12.34/56.78").toString());
		Assert.assertEquals("6170/2839",  new Rational("12.34E1/56.78").toString());
		Assert.assertEquals("617/28390",  new Rational("12.34/56.78E1").toString());
		Assert.assertEquals("617/2839",   new Rational("12.34E1/56.78E1").toString());
		Assert.assertEquals("617/28390",  new Rational("12.34E-1/56.78").toString());
		Assert.assertEquals("6170/2839",  new Rational("12.34/56.78E-1").toString());
		Assert.assertEquals("617/2839",   new Rational("12.34E-1/56.78E-1").toString());
		Assert.assertEquals("-617/2839",  new Rational("-12.34/56.78").toString());
		Assert.assertEquals("-6170/2839", new Rational("-12.34E1/56.78").toString());
		Assert.assertEquals("-617/28390", new Rational("-12.34/56.78E1").toString());
		Assert.assertEquals("-617/2839",  new Rational("-12.34E1/56.78E1").toString());
		Assert.assertEquals("-617/28390", new Rational("-12.34E-1/56.78").toString());
		Assert.assertEquals("-6170/2839", new Rational("-12.34/56.78E-1").toString());
		Assert.assertEquals("-617/2839",  new Rational("-12.34E-1/56.78E-1").toString());
		Assert.assertEquals("-617/2839",  new Rational("12.34/-56.78").toString());
		Assert.assertEquals("-6170/2839", new Rational("12.34E1/-56.78").toString());
		Assert.assertEquals("-617/28390", new Rational("12.34/-56.78E1").toString());
		Assert.assertEquals("-617/2839",  new Rational("12.34E1/-56.78E1").toString());
		Assert.assertEquals("-617/28390", new Rational("12.34E-1/-56.78").toString());
		Assert.assertEquals("-6170/2839", new Rational("12.34/-56.78E-1").toString());
		Assert.assertEquals("-617/2839",  new Rational("12.34E-1/-56.78E-1").toString());
		Assert.assertEquals("617/2839",   new Rational("-12.34/-56.78").toString());
		Assert.assertEquals("6170/2839",  new Rational("-12.34E1/-56.78").toString());
		Assert.assertEquals("617/28390",  new Rational("-12.34/-56.78E1").toString());
		Assert.assertEquals("617/2839",   new Rational("-12.34E1/-56.78E1").toString());
		Assert.assertEquals("617/28390",  new Rational("-12.34E-1/-56.78").toString());
		Assert.assertEquals("6170/2839",  new Rational("-12.34/-56.78E-1").toString());
		Assert.assertEquals("617/2839",   new Rational("-12.34E-1/-56.78E-1").toString());
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalExponentiationConstruction1() {
		new Rational("E").toString();
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalExponentiationConstruction2() {
		new Rational("E+1").toString();
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalExponentiationConstruction3() {
		new Rational("E+0").toString();
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalExponentiationConstruction4() {
		new Rational("E-0").toString();
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalExponentiationConstruction5() {
		new Rational("E+").toString();
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalExponentiationConstruction6() {
		new Rational("E-").toString();
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalFractionalExponent() {
		new Rational("1E2.5");
	}
	
	@Test(expected = NumberFormatException.class)
	public void testExponentOverflow() {
		new Rational("1E" + ((long)Integer.MAX_VALUE * 3));
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalExponentNesting() {
		new Rational("1E2E3").equals((new Rational(10)).pow(2000));
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalNullString() {
		new Rational((String)null);
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalNaN() {
		new Rational(String.valueOf(Double.NaN));
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalPositiveInfinity() {
		new Rational(String.valueOf(Double.POSITIVE_INFINITY));
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalNegativeInfinity() {
		new Rational(String.valueOf(Double.NEGATIVE_INFINITY));
	}
	
	@Test
	public void testClone() throws CloneNotSupportedException {
		Assert.assertTrue(Rational.ONE.equals(Rational.ONE));
		Assert.assertTrue(Rational.ONE.clone() != Rational.ONE);
		Assert.assertTrue(Rational.ONE.clone().equals(Rational.ONE));
		Assert.assertTrue(Rational.ONE.equals(Rational.ONE.clone()));
		
		Assert.assertTrue(new Rational(Rational.ONE) != Rational.ONE);
		Assert.assertTrue((new Rational(Rational.ONE)).equals(Rational.ONE));
		Assert.assertTrue(Rational.ONE.equals(new Rational(Rational.ONE)));
	}
	
	@Test
	public void testScaling() {
		// zero scale
		// "Rational normalization"
		Assert.assertTrue((new Rational(123456, 0, Rational.DEFAULT_RADIX)).toString().equals("123456"));
		Assert.assertTrue((new Rational(123456, 1, Rational.DEFAULT_RADIX)).toString().equals("61728/5"));
		Assert.assertTrue((new Rational(123456, 2, Rational.DEFAULT_RADIX)).toString().equals("30864/25"));
		Assert.assertTrue((new Rational(123456, 5, Rational.DEFAULT_RADIX)).toString().equals("3858/3125"));
		// <1
		Assert.assertTrue((new Rational(123456, 6, Rational.DEFAULT_RADIX)).toString().equals("1929/15625"));
		// negative scale
		Assert.assertTrue((new Rational(123456, -1, Rational.DEFAULT_RADIX)).toString().equals("1234560"));
		Assert.assertTrue((new Rational(123456, -2, Rational.DEFAULT_RADIX)).toString().equals("12345600"));
	}
	
	@Test
	public void testConstants() {
		Assert.assertTrue(Rational.ZERO.toString().equals("0"));
		Assert.assertTrue(Rational.ONE.toString().equals("1"));
		Assert.assertTrue(Rational.MINUS_ONE.toString().equals("-1"));
	}
	
	@Test
	public void testPredicates() {
		// predicates (isPositive, isNegative, isZero, isOne, isMinusOne, isInteger)
		Assert.assertTrue(!Rational.ZERO.isPositive());
		Assert.assertTrue(!(new Rational(0)).isPositive());
		Assert.assertTrue(Rational.ONE.isPositive());
		Assert.assertTrue((new Rational(1)).isPositive());
		Assert.assertTrue(!Rational.MINUS_ONE.isPositive());
		Assert.assertTrue(!(new Rational(-1)).isPositive());
		Assert.assertTrue((new Rational(77)).isPositive());
		Assert.assertTrue(!(new Rational(-77)).isPositive());
		Assert.assertTrue((new Rational(3, 5)).isPositive());
		Assert.assertTrue(!(new Rational(-3, 5)).isPositive());

		Assert.assertTrue(!Rational.ZERO.isNegative());
		Assert.assertTrue(!(new Rational(0)).isNegative());
		Assert.assertTrue(!Rational.ONE.isNegative());
		Assert.assertTrue(!(new Rational(1)).isNegative());
		Assert.assertTrue(Rational.MINUS_ONE.isNegative());
		Assert.assertTrue((new Rational(-1)).isNegative());
		Assert.assertTrue(!(new Rational(77)).isNegative());
		Assert.assertTrue((new Rational(-77)).isNegative());
		Assert.assertTrue(!(new Rational(3, 5)).isNegative());
		Assert.assertTrue((new Rational(-3, 5)).isNegative());

		Assert.assertTrue(Rational.ZERO.isZero());
		Assert.assertTrue((new Rational(0)).isZero());
		Assert.assertTrue(!Rational.ONE.isZero());
		Assert.assertTrue(!(new Rational(1)).isZero());
		Assert.assertTrue(!Rational.MINUS_ONE.isZero());
		Assert.assertTrue(!(new Rational(-1)).isZero());
		Assert.assertTrue(!(new Rational(77)).isZero());
		Assert.assertTrue(!(new Rational(-77)).isZero());
		Assert.assertTrue(!(new Rational(3, 5)).isZero());
		Assert.assertTrue(!(new Rational(-3, 5)).isZero());

		Assert.assertTrue(!Rational.ZERO.isOne());
		Assert.assertTrue(!(new Rational(0)).isOne());
		Assert.assertTrue(Rational.ONE.isOne());
		Assert.assertTrue((new Rational(1)).isOne());
		Assert.assertTrue(!Rational.MINUS_ONE.isOne());
		Assert.assertTrue(!(new Rational(-1)).isOne());
		Assert.assertTrue(!(new Rational(77)).isOne());
		Assert.assertTrue(!(new Rational(-77)).isOne());
		Assert.assertTrue(!(new Rational(3, 5)).isOne());
		Assert.assertTrue(!(new Rational(-3, 5)).isOne());

		Assert.assertTrue(!Rational.ZERO.isMinusOne());
		Assert.assertTrue(!(new Rational(0)).isMinusOne());
		Assert.assertTrue(!Rational.ONE.isMinusOne());
		Assert.assertTrue(!(new Rational(1)).isMinusOne());
		Assert.assertTrue(Rational.MINUS_ONE.isMinusOne());
		Assert.assertTrue((new Rational(-1)).isMinusOne());
		Assert.assertTrue(!(new Rational(77)).isMinusOne());
		Assert.assertTrue(!(new Rational(-77)).isMinusOne());
		Assert.assertTrue(!(new Rational(3, 5)).isMinusOne());
		Assert.assertTrue(!(new Rational(-3, 5)).isMinusOne());

		Assert.assertTrue(Rational.ZERO.isInteger());
		Assert.assertTrue((new Rational(0)).isInteger());
		Assert.assertTrue(Rational.ONE.isInteger());
		Assert.assertTrue((new Rational(1)).isInteger());
		Assert.assertTrue(Rational.MINUS_ONE.isInteger());
		Assert.assertTrue((new Rational(-1)).isInteger());
		Assert.assertTrue((new Rational(77)).isInteger());
		Assert.assertTrue((new Rational(-77)).isInteger());
		Assert.assertTrue(!(new Rational(3, 5)).isInteger());
		Assert.assertTrue(!(new Rational(-3, 5)).isInteger());
	}
	
	@Test
	public void testStringDot() {
		Assert.assertTrue((new Rational("1234.5678")).toStringDot(4).equals("1234.5678"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDot(5).equals("1234.56780"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDot(6).equals("1234.567800"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDot(3).equals("1234.568"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDot(2).equals("1234.57"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDot(1).equals("1234.6"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDot(0).equals("1235"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDot(-1).equals("1230"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDot(-2).equals("1200"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDot(-3).equals("1000"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDot(-4).equals("0"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDot(-5).equals("0"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDot(-6).equals("0"));

		Assert.assertTrue((new Rational("8765.4321")).toStringDot(-2).equals("8800"));
		Assert.assertTrue((new Rational("0.0148")).toStringDot(6).equals("0.014800"));
		Assert.assertTrue((new Rational("0.0148")).toStringDot(4).equals("0.0148"));
		Assert.assertTrue((new Rational("0.0148")).toStringDot(3).equals("0.015"));
		Assert.assertTrue((new Rational("0.0148")).toStringDot(2).equals("0.01"));
		Assert.assertTrue((new Rational("0.0148")).toStringDot(1).equals("0.0"));
		Assert.assertTrue((new Rational("0.001")).toStringDot(4).equals("0.0010"));
		Assert.assertTrue((new Rational("0.001")).toStringDot(3).equals("0.001"));
		Assert.assertTrue((new Rational("0.001")).toStringDot(2).equals("0.00"));
		Assert.assertTrue((new Rational("0.001")).toStringDot(1).equals("0.0"));
		Assert.assertTrue((new Rational("0.001")).toStringDot(0).equals("0"));
		Assert.assertTrue((new Rational("0.001")).toStringDot(-1).equals("0"));
		Assert.assertTrue((new Rational("0.001")).toStringDot(-2).equals("0"));

		Assert.assertTrue((new Rational("-1234.5678")).toStringDot(4).equals("-1234.5678"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDot(5).equals("-1234.56780"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDot(6).equals("-1234.567800"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDot(3).equals("-1234.568"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDot(2).equals("-1234.57"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDot(1).equals("-1234.6"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDot(0).equals("-1235"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDot(-1).equals("-1230"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDot(-2).equals("-1200"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDot(-3).equals("-1000"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDot(-4).equals("0"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDot(-5).equals("0"));

		Assert.assertTrue((new Rational("0.0")).toStringDot(4).equals("0.0000"));
		Assert.assertTrue((new Rational("0.0")).toStringDot(3).equals("0.000"));
		Assert.assertTrue((new Rational("0.0")).toStringDot(2).equals("0.00"));
		Assert.assertTrue((new Rational("0.0")).toStringDot(1).equals("0.0"));
		Assert.assertTrue((new Rational("0.0")).toStringDot(0).equals("0"));
		Assert.assertTrue((new Rational("0.0")).toStringDot(-1).equals("0"));
		Assert.assertTrue((new Rational("0.0")).toStringDot(-2).equals("0"));
		Assert.assertTrue((new Rational("0.0")).toStringDot(-3).equals("0"));
		Assert.assertTrue((new Rational("0.0")).toStringDot(-4).equals("0"));
	}
	
	@Test
	public void testStringDotRadix() {
		Assert.assertTrue((new Rational("1234.5678", 20)).toStringDot(3, 20).equals("1234.567"));
		Assert.assertTrue((new Rational("abcd.5b7g", 20)).toStringDot(-2, 20).equals("ac00"));
	}
	
	@Test
	public void testStringDotRelative() {
		Assert.assertTrue((new Rational("1234.5678")).toStringDotRelative(8).equals("1234.5678"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDotRelative(9).equals("1234.56780"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDotRelative(10).equals("1234.567800"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDotRelative(7).equals("1234.568"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDotRelative(6).equals("1234.57"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDotRelative(5).equals("1234.6"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDotRelative(4).equals("1235"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDotRelative(3).equals("1230"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDotRelative(2).equals("1200"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDotRelative(1).equals("1000"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDotRelative(0).equals("0"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDotRelative(-1).equals("0"));
		Assert.assertTrue((new Rational("1234.5678")).toStringDotRelative(-2).equals("0"));

		Assert.assertTrue((new Rational("-1234.5678")).toStringDotRelative(8).equals("-1234.5678"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDotRelative(9).equals("-1234.56780"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDotRelative(10).equals("-1234.567800"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDotRelative(7).equals("-1234.568"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDotRelative(6).equals("-1234.57"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDotRelative(5).equals("-1234.6"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDotRelative(4).equals("-1235"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDotRelative(3).equals("-1230"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDotRelative(2).equals("-1200"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDotRelative(1).equals("-1000"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDotRelative(0).equals("0"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDotRelative(-1).equals("0"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringDotRelative(-2).equals("0"));

		Assert.assertTrue((new Rational("0.00012345678")).toStringDotRelative(8).equals("0.00012345678"));
		Assert.assertTrue((new Rational("0.00012345678")).toStringDotRelative(9).equals("0.000123456780"));
		Assert.assertTrue((new Rational("0.00012345678")).toStringDotRelative(10).equals("0.0001234567800"));
		Assert.assertTrue((new Rational("0.00012345678")).toStringDotRelative(7).equals("0.0001234568"));
		Assert.assertTrue((new Rational("0.00012345678")).toStringDotRelative(6).equals("0.000123457"));
		Assert.assertTrue((new Rational("0.00012345678")).toStringDotRelative(5).equals("0.00012346"));
		Assert.assertTrue((new Rational("0.00012345678")).toStringDotRelative(4).equals("0.0001235"));
		Assert.assertTrue((new Rational("0.00012345678")).toStringDotRelative(3).equals("0.000123"));
		Assert.assertTrue((new Rational("0.00012345678")).toStringDotRelative(2).equals("0.00012"));
		Assert.assertTrue((new Rational("0.00012345678")).toStringDotRelative(1).equals("0.0001"));
		Assert.assertTrue((new Rational("0.00012345678")).toStringDotRelative(0).equals("0"));
		Assert.assertTrue((new Rational("0.00012345678")).toStringDotRelative(-1).equals("0"));
		Assert.assertTrue((new Rational("0.00012345678")).toStringDotRelative(-2).equals("0"));

		Assert.assertTrue((new Rational("-0.00012345678")).toStringDotRelative(8).equals("-0.00012345678"));
		Assert.assertTrue((new Rational("-0.00012345678")).toStringDotRelative(9).equals("-0.000123456780"));
		Assert.assertTrue((new Rational("-0.00012345678")).toStringDotRelative(10).equals("-0.0001234567800"));
		Assert.assertTrue((new Rational("-0.00012345678")).toStringDotRelative(7).equals("-0.0001234568"));
		Assert.assertTrue((new Rational("-0.00012345678")).toStringDotRelative(6).equals("-0.000123457"));
		Assert.assertTrue((new Rational("-0.00012345678")).toStringDotRelative(5).equals("-0.00012346"));
		Assert.assertTrue((new Rational("-0.00012345678")).toStringDotRelative(4).equals("-0.0001235"));
		Assert.assertTrue((new Rational("-0.00012345678")).toStringDotRelative(3).equals("-0.000123"));
		Assert.assertTrue((new Rational("-0.00012345678")).toStringDotRelative(2).equals("-0.00012"));
		Assert.assertTrue((new Rational("-0.00012345678")).toStringDotRelative(1).equals("-0.0001"));
		Assert.assertTrue((new Rational("-0.00012345678")).toStringDotRelative(0).equals("0"));
		Assert.assertTrue((new Rational("-0.00012345678")).toStringDotRelative(-1).equals("0"));
		Assert.assertTrue((new Rational("-0.00012345678")).toStringDotRelative(-2).equals("0"));

		Assert.assertTrue((new Rational("8765.4321")).toStringDotRelative(8).equals("8765.4321"));
		Assert.assertTrue((new Rational("8765.4321")).toStringDotRelative(9).equals("8765.43210"));
		Assert.assertTrue((new Rational("8765.4321")).toStringDotRelative(10).equals("8765.432100"));
		Assert.assertTrue((new Rational("8765.4321")).toStringDotRelative(7).equals("8765.432"));
		Assert.assertTrue((new Rational("8765.4321")).toStringDotRelative(6).equals("8765.43"));
		Assert.assertTrue((new Rational("8765.4321")).toStringDotRelative(5).equals("8765.4"));
		Assert.assertTrue((new Rational("8765.4321")).toStringDotRelative(4).equals("8765"));
		Assert.assertTrue((new Rational("8765.4321")).toStringDotRelative(3).equals("8770"));
		Assert.assertTrue((new Rational("8765.4321")).toStringDotRelative(2).equals("8800"));
		Assert.assertTrue((new Rational("8765.4321")).toStringDotRelative(1).equals("9000"));
		Assert.assertTrue((new Rational("8765.4321")).toStringDotRelative(0).equals("0"));
		Assert.assertTrue((new Rational("8765.4321")).toStringDotRelative(-1).equals("0"));
		Assert.assertTrue((new Rational("8765.4321")).toStringDotRelative(-2).equals("0"));

		Assert.assertTrue((new Rational("0.0")).toStringDotRelative(4).equals("0"));
		Assert.assertTrue((new Rational("0.0")).toStringDotRelative(3).equals("0"));
		Assert.assertTrue((new Rational("0.0")).toStringDotRelative(2).equals("0"));
		Assert.assertTrue((new Rational("0.0")).toStringDotRelative(1).equals("0"));
		Assert.assertTrue((new Rational("0.0")).toStringDotRelative(0).equals("0"));
		Assert.assertTrue((new Rational("0.0")).toStringDotRelative(-1).equals("0"));
		Assert.assertTrue((new Rational("0.0")).toStringDotRelative(-2).equals("0"));
		Assert.assertTrue((new Rational("0.0")).toStringDotRelative(-3).equals("0"));
		Assert.assertTrue((new Rational("0.0")).toStringDotRelative(-4).equals("0"));

		Assert.assertTrue((new Rational(1499)).toStringDotRelative(1).equals("1000"));
		Assert.assertTrue((new Rational(1500)).toStringDotRelative(1).equals("2000"));
		Assert.assertTrue((new Rational(1501)).toStringDotRelative(1).equals("2000"));
		Assert.assertTrue((new Rational(1001)).toStringDotRelative(1).equals("1000"));
		Assert.assertTrue((new Rational(1000)).toStringDotRelative(1).equals("1000"));
		Assert.assertTrue((new Rational(999)).toStringDotRelative(1).equals("1000"));
		Assert.assertTrue((new Rational(951)).toStringDotRelative(1).equals("1000"));
		Assert.assertTrue((new Rational(950)).toStringDotRelative(1).equals("1000"));
		Assert.assertTrue((new Rational(949)).toStringDotRelative(1).equals("900"));

		// check inverted radix pow cases too
		Assert.assertTrue((new Rational(1, 1)).toStringDotRelative(1).equals("1"));
		Assert.assertTrue((new Rational(1, 2)).toStringDotRelative(1).equals("0.5"));
		Assert.assertTrue((new Rational(1, 3)).toStringDotRelative(1).equals("0.3"));
		Assert.assertTrue((new Rational(1, 5)).toStringDotRelative(1).equals("0.2"));
		Assert.assertTrue((new Rational(1, 10)).toStringDotRelative(1).equals("0.1"));
		Assert.assertTrue((new Rational(1, 20)).toStringDotRelative(1).equals("0.05"));
		Assert.assertTrue((new Rational(1, 30)).toStringDotRelative(1).equals("0.03"));
		Assert.assertTrue((new Rational(1, 50)).toStringDotRelative(1).equals("0.02"));
		Assert.assertTrue((new Rational(1, 100)).toStringDotRelative(1).equals("0.01"));
		Assert.assertTrue((new Rational(1, 200)).toStringDotRelative(1).equals("0.005"));
		Assert.assertTrue((new Rational(1, 300)).toStringDotRelative(1).equals("0.003"));
		Assert.assertTrue((new Rational(1, 500)).toStringDotRelative(1).equals("0.002"));
		Assert.assertTrue((new Rational(1, 1000)).toStringDotRelative(1).equals("0.001"));
		Assert.assertTrue((new Rational(1, 4)).toStringDotRelative(1).equals("0.3"));
		Assert.assertTrue((new Rational(1, 11)).toStringDotRelative(1).equals("0.09"));
		Assert.assertTrue((new Rational(1, 12)).toStringDotRelative(1).equals("0.08"));
		Assert.assertTrue((new Rational(1, 31)).toStringDotRelative(1).equals("0.03"));
		Assert.assertTrue((new Rational(1, 99)).toStringDotRelative(1).equals("0.01"));
		Assert.assertTrue((new Rational("0.0100001")).toStringDotRelative(1).equals("0.01"));

		// intermediately excess zeros
		Assert.assertTrue((new Rational(1, 101)).toStringDotRelative(1).equals("0.01"));
		Assert.assertTrue((new Rational("0.0099999")).toStringDotRelative(1).equals("0.01"));
	}
	
	@Test
	public void testExponentRepresentation() {
		Assert.assertTrue((new Rational("1234.5678")).toStringExponent(8).equals("1.2345678E3"));
		Assert.assertTrue((new Rational("1234.5678")).toStringExponent(4).equals("1.235E3"));
		Assert.assertTrue((new Rational("1234.5678")).toStringExponent(2).equals("1.2E3"));
		Assert.assertTrue((new Rational("1234.5678")).toStringExponent(1).equals("1E3"));
		Assert.assertTrue((new Rational("1234.5678")).toStringExponent(0).equals("0"));
		Assert.assertTrue((new Rational("0.00012345678")).toStringExponent(8).equals("1.2345678E-4"));
		Assert.assertTrue((new Rational("0.00012345678")).toStringExponent(4).equals("1.235E-4"));
		Assert.assertTrue((new Rational("0.00012345678")).toStringExponent(2).equals("1.2E-4"));
		Assert.assertTrue((new Rational("0.00012345678")).toStringExponent(1).equals("1E-4"));
		Assert.assertTrue((new Rational("0.00012345678")).toStringExponent(0).equals("0"));

		Assert.assertTrue((new Rational("-1234.5678")).toStringExponent(8).equals("-1.2345678E3"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringExponent(4).equals("-1.235E3"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringExponent(2).equals("-1.2E3"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringExponent(1).equals("-1E3"));
		Assert.assertTrue((new Rational("-1234.5678")).toStringExponent(0).equals("0"));
		Assert.assertTrue((new Rational("-0.00012345678")).toStringExponent(8).equals("-1.2345678E-4"));
		Assert.assertTrue((new Rational("-0.00012345678")).toStringExponent(4).equals("-1.235E-4"));
		Assert.assertTrue((new Rational("-0.00012345678")).toStringExponent(2).equals("-1.2E-4"));
		Assert.assertTrue((new Rational("-0.00012345678")).toStringExponent(1).equals("-1E-4"));
		Assert.assertTrue((new Rational("-0.00012345678")).toStringExponent(0).equals("0"));

		Assert.assertTrue((new Rational("1234")).toStringExponent(8).equals("1.234E3"));
		Assert.assertTrue((new Rational("1234")).toStringExponent(4).equals("1.234E3"));
		Assert.assertTrue((new Rational("1234")).toStringExponent(2).equals("1.2E3"));
		Assert.assertTrue((new Rational("1234")).toStringExponent(1).equals("1E3"));
		Assert.assertTrue((new Rational("1234")).toStringExponent(0).equals("0"));

		Assert.assertTrue((new Rational("10")).toStringExponent(6).equals("1E1"));
		Assert.assertTrue((new Rational("1")).toStringExponent(6).equals("1"));
		Assert.assertTrue((new Rational("0")).toStringExponent(6).equals("0"));
		Assert.assertTrue((new Rational("0.1")).toStringExponent(6).equals("1E-1"));
		Assert.assertTrue((new Rational("10")).toStringExponent(1).equals("1E1"));
		Assert.assertTrue((new Rational("1")).toStringExponent(1).equals("1"));
		Assert.assertTrue((new Rational("0")).toStringExponent(1).equals("0"));
		Assert.assertTrue((new Rational("0.1")).toStringExponent(1).equals("1E-1"));

		Assert.assertTrue(Rational.valueOf("2E222").toStringExponent(4).equals("2E222"));
		Assert.assertTrue(Rational.valueOf("-2E222").toStringExponent(4).equals("-2E222"));
		Assert.assertTrue(Rational.valueOf("2E-222").toStringExponent(4).equals("2E-222"));
		Assert.assertTrue(Rational.valueOf("-2E-222").toStringExponent(4).equals("-2E-222"));

		// non-default radix
		Assert.assertTrue(new Rational("2E222", 5).toStringExponent(4, 5).equals("2E222"));
		Assert.assertTrue(new Rational("-2E222", 5).toStringExponent(4, 5).equals("-2E222"));
		Assert.assertTrue(new Rational("2E-222", 5).toStringExponent(4, 5).equals("2E-222"));
		Assert.assertTrue(new Rational("-2E-222", 5).toStringExponent(4, 5).equals("-2E-222"));
	}
	
	@Test
	public void testAdd() {
		Assert.assertTrue((new Rational(3, 5)).add(new Rational(7, 11)).toString().equals("68/55"));
		Assert.assertTrue((new Rational(3, 5)).add(new Rational(-7, 11)).toString().equals("-2/55"));
		Assert.assertTrue((new Rational(-3, 5)).add(new Rational(7, 11)).toString().equals("2/55"));
		Assert.assertTrue((new Rational(-3, 5)).add(new Rational(-7, 11)).toString().equals("-68/55"));
		// same denominator
		Assert.assertTrue((new Rational(3, 5)).add(new Rational(1, 5)).toString().equals("4/5"));
		// with integers
		Assert.assertTrue((new Rational(3, 5)).add(new Rational(1)).toString().equals("8/5"));
		Assert.assertTrue((new Rational(2)).add(new Rational(3, 5)).toString().equals("13/5"));
		// zero
		Assert.assertTrue((new Rational(3, 5)).add(Rational.ZERO).toString().equals("3/5"));
		Assert.assertTrue(Rational.ZERO.add(new Rational(3, 5)).toString().equals("3/5"));
	}
	
	@Test
	public void testSubtract() {
		Assert.assertTrue((new Rational(3, 5)).subtract(new Rational(7, 11)).toString().equals("-2/55"));
		Assert.assertTrue((new Rational(3, 5)).subtract(new Rational(-7, 11)).toString().equals("68/55"));
		Assert.assertTrue((new Rational(-3, 5)).subtract(new Rational(7, 11)).toString().equals("-68/55"));
		Assert.assertTrue((new Rational(-3, 5)).subtract(new Rational(-7, 11)).toString().equals("2/55"));
		// same denominator
		Assert.assertTrue((new Rational(3, 5)).subtract(new Rational(1, 5)).toString().equals("2/5"));
		// with integers
		Assert.assertTrue((new Rational(3, 5)).subtract(new Rational(1)).toString().equals("-2/5"));
		Assert.assertTrue((new Rational(2)).subtract(new Rational(3, 5)).toString().equals("7/5"));
		// zero
		Assert.assertTrue((new Rational(3, 5)).subtract(Rational.ZERO).toString().equals("3/5"));
		Assert.assertTrue(Rational.ZERO.subtract(new Rational(3, 5)).toString().equals("-3/5"));

		// normalization, e.g after subtract
		// "Rational normalization"
		Assert.assertTrue((new Rational(7, 5)).subtract(new Rational(2, 5)).compareTo(1) == 0);
		Assert.assertTrue((new Rational(7, 5)).subtract(new Rational(7, 5)).compareTo(0) == 0);
		Assert.assertTrue((new Rational(7, 5)).subtract(new Rational(12, 5)).compareTo(-1) == 0);
	}
	
	@Test
	public void testMultiply() {
		// "Rational multiply"
		Assert.assertTrue((new Rational(3, 5)).multiply(new Rational(7, 11)).toString().equals("21/55"));
		Assert.assertTrue((new Rational(3, 5)).multiply(new Rational(-7, 11)).toString().equals("-21/55"));
		Assert.assertTrue((new Rational(-3, 5)).multiply(new Rational(7, 11)).toString().equals("-21/55"));
		Assert.assertTrue((new Rational(-3, 5)).multiply(new Rational(-7, 11)).toString().equals("21/55"));
		Assert.assertTrue((new Rational(3, 5)).multiply(7).toString().equals("21/5"));
		Assert.assertTrue((new Rational(-3, 5)).multiply(7).toString().equals("-21/5"));
		Assert.assertTrue((new Rational(3, 5)).multiply(-7).toString().equals("-21/5"));
		Assert.assertTrue((new Rational(-3, 5)).multiply(-7).toString().equals("21/5"));

		// multiply() with integers, 0, etc. (some repetitions too)
		// "Rational multiply"
		Assert.assertTrue((new Rational(3, 5)).multiply(new Rational(7, 1)).toString().equals("21/5"));
		Assert.assertTrue((new Rational(3, 5)).multiply(new Rational(1, 7)).toString().equals("3/35"));
		Assert.assertTrue((new Rational(3, 1)).multiply(new Rational(7, 11)).toString().equals("21/11"));
		Assert.assertTrue((new Rational(3, 5)).multiply(new Rational(0)).toString().equals("0"));
		Assert.assertTrue((new Rational(0)).multiply(new Rational(3, 5)).toString().equals("0"));
		Assert.assertTrue((new Rational(3, 5)).multiply(new Rational(1)).toString().equals("3/5"));
		Assert.assertTrue((new Rational(3, 5)).multiply(new Rational(-1)).toString().equals("-3/5"));
		Assert.assertTrue((new Rational(3, 5)).multiply(new Rational(-1, 3)).toString().equals("-1/5"));

		// special cases (zeroing, negating)
		Assert.assertTrue(Rational.ZERO.multiply(Rational.ZERO).equals(Rational.ZERO));
		Assert.assertTrue(Rational.ZERO.multiply(Rational.ONE).equals(Rational.ZERO));
		Assert.assertTrue(Rational.ONE.multiply(Rational.ZERO).equals(Rational.ZERO));
		Assert.assertTrue(Rational.ZERO.multiply(Rational.MINUS_ONE).equals(Rational.ZERO));
		Assert.assertTrue(Rational.MINUS_ONE.multiply(Rational.ZERO).equals(Rational.ZERO));
		Assert.assertTrue(Rational.ZERO.multiply(new Rational(5)).equals(Rational.ZERO));
		Assert.assertTrue((new Rational(5)).multiply(Rational.ZERO).equals(Rational.ZERO));
		Assert.assertTrue(Rational.ZERO.multiply(new Rational(-5)).equals(Rational.ZERO));
		Assert.assertTrue((new Rational(-5)).multiply(Rational.ZERO).equals(Rational.ZERO));
		Assert.assertTrue(Rational.ONE.multiply(Rational.ONE).equals(Rational.ONE));
		Assert.assertTrue(Rational.ONE.multiply(Rational.MINUS_ONE).equals(Rational.MINUS_ONE));
		Assert.assertTrue(Rational.MINUS_ONE.multiply(Rational.ONE).equals(Rational.MINUS_ONE));
		Assert.assertTrue(Rational.ONE.multiply(new Rational(5)).equals(new Rational(5)));
		Assert.assertTrue((new Rational(5)).multiply(Rational.ONE).equals(new Rational(5)));
		Assert.assertTrue(Rational.ONE.multiply(new Rational(-5)).equals(new Rational(-5)));
		Assert.assertTrue((new Rational(-5)).multiply(Rational.ONE).equals(new Rational(-5)));
		Assert.assertTrue(Rational.MINUS_ONE.multiply(Rational.MINUS_ONE).equals(Rational.ONE));
		Assert.assertTrue(Rational.MINUS_ONE.multiply(new Rational(5)).equals(new Rational(-5)));
		Assert.assertTrue((new Rational(5)).multiply(Rational.MINUS_ONE).equals(new Rational(-5)));
		Assert.assertTrue(Rational.MINUS_ONE.multiply(new Rational(-5)).equals(new Rational(5)));
		Assert.assertTrue((new Rational(-5)).multiply(Rational.MINUS_ONE).equals(new Rational(5)));
	}
	
	@Test
	public void testDivide() {
		Assert.assertTrue((new Rational(3, 5)).divide(new Rational(7, 11)).toString().equals("33/35"));
		Assert.assertTrue((new Rational(3, 5)).divide(new Rational(-7, 11)).toString().equals("-33/35"));
		Assert.assertTrue((new Rational(-3, 5)).divide(new Rational(7, 11)).toString().equals("-33/35"));
		Assert.assertTrue((new Rational(-3, 5)).divide(new Rational(-7, 11)).toString().equals("33/35"));
		Assert.assertTrue((new Rational(3, 5)).divide(7).toString().equals("3/35"));
		Assert.assertTrue((new Rational(-3, 5)).divide(7).toString().equals("-3/35"));
		Assert.assertTrue((new Rational(3, 5)).divide(-7).toString().equals("-3/35"));
		Assert.assertTrue((new Rational(-3, 5)).divide(-7).toString().equals("3/35"));

		Assert.assertTrue((new Rational(0)).divide(new Rational(7, 11)).toString().equals("0"));
	}
	
	@Test(expected = ArithmeticException.class)
	public void testIllegalDivide1() {
		new Rational(3, 5).divide(new Rational(0));
	}
	
	@Test(expected = ArithmeticException.class)
	public void testIllegalDivide2() {
		new Rational(-3, 5).divide(new Rational(0));
	}
	
	@Test(expected = ArithmeticException.class)
	public void testIllegalDivide3() {
		new Rational(3, 5).divide(0);
	}
	
	@Test(expected = ArithmeticException.class)
	public void testIllegalDivide4() {
		new Rational(-3, 5).divide(0);
	}
	
	@Test(expected = ArithmeticException.class)
	public void testIllegalDivide5() {
		new Rational(0).divide(0);
	}
	
	@Test
	public void testPow() {
		Assert.assertTrue((new Rational(3, 5)).pow(7).toString().equals("2187/78125"));
		Assert.assertTrue((new Rational(-3, 5)).pow(7).toString().equals("-2187/78125"));
		Assert.assertTrue((new Rational(3, 5)).pow(-7).toString().equals("78125/2187"));
		Assert.assertTrue((new Rational(-3, 5)).pow(-7).toString().equals("-78125/2187"));
		Assert.assertTrue((new Rational(3, 5)).pow(6).toString().equals("729/15625"));
		Assert.assertTrue((new Rational(-3, 5)).pow(6).toString().equals("729/15625"));
		Assert.assertTrue((new Rational(3, 5)).pow(0).toString().equals("1"));
		Assert.assertTrue((new Rational(-3, 5)).pow(0).toString().equals("1"));
		Assert.assertTrue((new Rational(0)).pow(1).toString().equals("0"));
		Assert.assertTrue((new Rational(1)).pow(0).toString().equals("1"));

		Assert.assertTrue((new Rational(3, 5)).pow(0).equals(Rational.ONE));
		Assert.assertTrue((new Rational(3, 5)).pow(1).equals(new Rational(3, 5)));
		Assert.assertTrue((new Rational(3, 5)).pow(-1).equals((new Rational(3, 5)).invert()));
		Assert.assertTrue((new Rational(2)).pow(2).equals(new Rational(4)));

		// special cases
		Assert.assertTrue(Rational.ZERO.pow(1).equals(Rational.ZERO));
		Assert.assertTrue(Rational.ZERO.pow(2).equals(Rational.ZERO));
		Assert.assertTrue(Rational.ZERO.pow(3).equals(Rational.ZERO));
		Assert.assertTrue(Rational.ZERO.pow(4).equals(Rational.ZERO));
		Assert.assertTrue(Rational.ONE.pow(0).equals(Rational.ONE));
		Assert.assertTrue(Rational.ONE.pow(1).equals(Rational.ONE));
		Assert.assertTrue(Rational.ONE.pow(2).equals(Rational.ONE));
		Assert.assertTrue(Rational.ONE.pow(3).equals(Rational.ONE));
		Assert.assertTrue(Rational.ONE.pow(4).equals(Rational.ONE));
		Assert.assertTrue(Rational.ONE.pow(-1).equals(Rational.ONE));
		Assert.assertTrue(Rational.ONE.pow(-2).equals(Rational.ONE));
		Assert.assertTrue(Rational.ONE.pow(-3).equals(Rational.ONE));
		Assert.assertTrue(Rational.ONE.pow(-4).equals(Rational.ONE));
		Assert.assertTrue(Rational.MINUS_ONE.pow(0).equals(Rational.ONE));
		Assert.assertTrue(Rational.MINUS_ONE.pow(1).equals(Rational.MINUS_ONE));
		Assert.assertTrue(Rational.MINUS_ONE.pow(2).equals(Rational.ONE));
		Assert.assertTrue(Rational.MINUS_ONE.pow(3).equals(Rational.MINUS_ONE));
		Assert.assertTrue(Rational.MINUS_ONE.pow(4).equals(Rational.ONE));
		Assert.assertTrue(Rational.MINUS_ONE.pow(-1).equals(Rational.MINUS_ONE));
		Assert.assertTrue(Rational.MINUS_ONE.pow(-2).equals(Rational.ONE));
		Assert.assertTrue(Rational.MINUS_ONE.pow(-3).equals(Rational.MINUS_ONE));
		Assert.assertTrue(Rational.MINUS_ONE.pow(-4).equals(Rational.ONE));
	}
	
	@Test(expected = ArithmeticException.class)
	public void testIllegalPow1() {
		(new Rational(0)).pow(0);
	}
	
	@Test(expected = ArithmeticException.class)
	public void testIllegalPow2() {
		Rational.ZERO.pow(-1);
	}
	
	@Test(expected = ArithmeticException.class)
	public void testIllegalPow3() {
		Rational.ZERO.pow(-2);
	}
	
	@Test
	public void testRemainder() {
		Assert.assertTrue((new Rational(5)).remainder(new Rational(3)).equals(new Rational(2)));
		Assert.assertTrue((new Rational(-5)).remainder(new Rational(3)).equals(new Rational(-2)));
		Assert.assertTrue((new Rational(5)).remainder(new Rational(-3)).equals(new Rational(2)));
		Assert.assertTrue((new Rational(-5)).remainder(new Rational(-3)).equals(new Rational(-2)));
		Assert.assertTrue((new Rational(0)).remainder(new Rational(1)).equals(new Rational(0)));
		Assert.assertTrue((new Rational("5.6")).remainder(new Rational("1.8")).equals(new Rational(1, 5)));
		Assert.assertTrue((new Rational("-5.6")).remainder(new Rational("1.8")).equals(new Rational(-1, 5)));
		Assert.assertTrue((new Rational("5.6")).remainder(new Rational("-1.8")).equals(new Rational(1, 5)));
		Assert.assertTrue((new Rational("-5.6")).remainder(new Rational("-1.8")).equals(new Rational(-1, 5)));
		Assert.assertTrue((new Rational("1")).remainder(new Rational("0.13")).equals(new Rational("0.09")));
	}
	
	@Test(expected = ArithmeticException.class)
	public void testIllegalRemainder1() {
		Rational.ONE.remainder(0);
	}
	
	@Test(expected = ArithmeticException.class)
	public void testIllegalRemainder2() {
		Rational.ZERO.remainder(0);
	}
	
	@Test
	public void testMod() {
		Assert.assertTrue((new Rational(5)).mod(new Rational(3)).equals(new Rational(2)));
		Assert.assertTrue((new Rational(-5)).mod(new Rational(3)).equals(new Rational(1)));
		Assert.assertTrue((new Rational(5)).mod(new Rational(-3)).equals(new Rational(-1)));
		Assert.assertTrue((new Rational(-5)).mod(new Rational(-3)).equals(new Rational(-2)));
		Assert.assertTrue((new Rational(0)).mod(new Rational(1)).equals(new Rational(0)));
		Assert.assertTrue((new Rational("5.6")).mod(new Rational("1.8")).equals(new Rational(1, 5)));
		Assert.assertTrue((new Rational("-5.6")).mod(new Rational("1.8")).equals(new Rational(8, 5)));
		Assert.assertTrue((new Rational("5.6")).mod(new Rational("-1.8")).equals(new Rational(-8, 5)));
		Assert.assertTrue((new Rational("-5.6")).mod(new Rational("-1.8")).equals(new Rational(-1, 5)));
		Assert.assertTrue((new Rational("1")).mod(new Rational("0.13")).equals(new Rational("0.09")));
	}
	
	@Test(expected = ArithmeticException.class)
	public void testIllegalMod1() {
		Rational.ONE.mod(0);
	}
	
	@Test(expected = ArithmeticException.class)
	public void testIllegalMod2() {
		Rational.ZERO.mod(0);
	}
	
	@Test
	public void testSignum() {
		Assert.assertTrue((new Rational(0)).signum() == 0);
		Assert.assertTrue((new Rational(1)).signum() == 1);
		Assert.assertTrue((new Rational(-1)).signum() == -1);
		Assert.assertTrue((new Rational(2)).signum() == 1);
		Assert.assertTrue((new Rational(-2)).signum() == -1);
		Assert.assertTrue((new Rational(3, 5)).signum() == 1);
		Assert.assertTrue((new Rational(-3, 5)).signum() == -1);
	}
	
	@Test
	public void testAbs() {
		Assert.assertTrue((new Rational(0)).abs().toString().equals("0"));
		Assert.assertTrue((new Rational(3, 5)).abs().toString().equals("3/5"));
		Assert.assertTrue((new Rational(-3, 5)).abs().toString().equals("3/5"));
		Assert.assertTrue((new Rational(1)).abs().toString().equals("1"));
		Assert.assertTrue((new Rational(-1)).abs().toString().equals("1"));
		Assert.assertTrue(Rational.ZERO.abs().equals(Rational.ZERO));
		Assert.assertTrue(Rational.ONE.abs().equals(Rational.ONE));
		Assert.assertTrue(Rational.MINUS_ONE.abs().equals(Rational.ONE));
	}
	
	@Test
	public void testNegate() {
		Assert.assertTrue((new Rational(0)).negate().toString().equals("0"));
		Assert.assertTrue((new Rational(1)).negate().toString().equals("-1"));
		Assert.assertTrue((new Rational(-1)).negate().toString().equals("1"));
		Assert.assertTrue((new Rational(3, 5)).negate().toString().equals("-3/5"));
		Assert.assertTrue((new Rational(-3, 5)).negate().toString().equals("3/5"));
		Assert.assertTrue(Rational.ZERO.negate().equals(Rational.ZERO));
		Assert.assertTrue(Rational.ONE.negate().equals(Rational.MINUS_ONE));
		Assert.assertTrue(Rational.MINUS_ONE.negate().equals(Rational.ONE));
	}
	
	@Test
	public void testInvert() {
		Assert.assertTrue((new Rational(3, 5)).invert().toString().equals("5/3"));
		Assert.assertTrue((new Rational(-3, 5)).invert().toString().equals("-5/3"));
		Assert.assertTrue((new Rational(11, 7)).invert().toString().equals("7/11"));
		Assert.assertTrue((new Rational(-11, 7)).invert().toString().equals("-7/11"));
		Assert.assertTrue((new Rational(1)).invert().toString().equals("1"));
		Assert.assertTrue((new Rational(-1)).invert().toString().equals("-1"));
		Assert.assertTrue((new Rational(2)).invert().toString().equals("1/2"));
		Assert.assertTrue(Rational.ONE.invert().equals(Rational.ONE));
		Assert.assertTrue(Rational.MINUS_ONE.invert().equals(Rational.MINUS_ONE));
	}
	
	@Test(expected = ArithmeticException.class)
	public void testIllegalInvert() {
		Rational.ZERO.invert();
	}
	
	@Test
	public void testMin() {
		Assert.assertTrue((new Rational(3, 5)).min(new Rational(7, 11)).toString().equals("3/5"));
		Assert.assertTrue((new Rational(-3, 5)).min(new Rational(7, 11)).toString().equals("-3/5"));
		Assert.assertTrue((new Rational(3, 5)).min(new Rational(-7, 11)).toString().equals("-7/11"));
		Assert.assertTrue((new Rational(-3, 5)).min(new Rational(-7, 11)).toString().equals("-7/11"));
		Assert.assertTrue((new Rational(7, 11)).min(new Rational(3, 5)).toString().equals("3/5"));
	}
	
	@Test
	public void testMax() {
		Assert.assertTrue((new Rational(3, 5)).max(new Rational(7, 11)).toString().equals("7/11"));
		Assert.assertTrue((new Rational(-3, 5)).max(new Rational(7, 11)).toString().equals("7/11"));
		Assert.assertTrue((new Rational(3, 5)).max(new Rational(-7, 11)).toString().equals("3/5"));
		Assert.assertTrue((new Rational(-3, 5)).max(new Rational(-7, 11)).toString().equals("-3/5"));
		Assert.assertTrue((new Rational(7, 11)).max(new Rational(3, 5)).toString().equals("7/11"));
	}
	
	@Test
	public void testEquals() {
		// "Rational [polymorph] equals"
		Assert.assertTrue(Rational.ONE.equals(Rational.ONE));
		Assert.assertTrue(Rational.ONE.equals(new Rational(3, 3)));
		Assert.assertTrue(Rational.ONE.equals(new Rational(987654, 987654)));
		Assert.assertTrue(!Rational.ONE.equals(new Rational(987653, 987654)));
		Assert.assertTrue(Rational.ZERO.equals(new Rational(0, 987654)));
		Assert.assertTrue(Rational.MINUS_ONE.equals(new Rational(-987654, 987654)));
		Assert.assertTrue(!Rational.MINUS_ONE.equals(new Rational(-987653, 987654)));
		Assert.assertTrue((new Rational(3, 5)).equals(new Rational(3, 5)));
		Assert.assertTrue(!(new Rational(3, 5)).equals(new Rational(5, 3)));
		Assert.assertTrue(Rational.ZERO.equals(Rational.ZERO));
		Assert.assertTrue(Rational.ONE.equals(Rational.ONE));
		Assert.assertTrue(Rational.MINUS_ONE.equals(Rational.MINUS_ONE));
		Assert.assertTrue(!Rational.ZERO.equals(Rational.ONE));
		Assert.assertTrue(!Rational.ONE.equals(Rational.ZERO));
		Assert.assertTrue(!Rational.ONE.equals(Rational.MINUS_ONE));
		Assert.assertTrue(!Rational.MINUS_ONE.equals(Rational.ONE));

		// following tests address things that changed from earlier version;
		// i.e. will fail with that version
		Assert.assertTrue(!Rational.ZERO.equals(new Integer(0)));
		Assert.assertTrue(!(new Rational(3)).equals(new Integer(3)));
		Assert.assertTrue(!Rational.ZERO.equals(new Long(0)));
		Assert.assertTrue(!(new Rational(3)).equals(new Long(3)));
		Assert.assertTrue(!Rational.ZERO.equals("0"));
		Assert.assertTrue(!(new Rational(3)).equals("3"));

		Assert.assertTrue(!(new Integer(0)).equals(Rational.ZERO));
		Assert.assertTrue(!(new Long(0)).equals(Rational.ZERO));
		Assert.assertTrue(!(new String("0")).equals(Rational.ZERO));

		Assert.assertTrue(!Rational.ONE.equals(new RuntimeException()));
		Assert.assertTrue(!(new RuntimeException()).equals(Rational.ONE));
	}
	
	@Test
	public void testHashCode() {
		Assert.assertTrue((new Rational(3, 5)).hashCode() == (new Rational(6, 10)).hashCode());

		Assert.assertTrue(Rational.ONE.hashCode() != Rational.ZERO.hashCode());
		Assert.assertTrue((new Rational(3, 5)).hashCode() != (new Rational(5, 3)).hashCode());
		Assert.assertTrue((new Rational(3, 5)).hashCode() != (new Rational(-3, 5)).hashCode());
		Assert.assertTrue((new Rational(4)).hashCode() != (new Rational(8)).hashCode());
	}
	
	@Test
	public void testCompareTo() {
		Assert.assertTrue((new Rational(3, 5)).compareTo(new Rational(3, 5)) == 0);
		Assert.assertTrue((new Rational(3, 5)).compareTo(new Rational(5, 3)) == -1);
		Assert.assertTrue((new Rational(5, 3)).compareTo(new Rational(3, 5)) == 1);
		Assert.assertTrue((new Rational(3, 5)).compareTo(new Rational(-5, 3)) == 1);
		Assert.assertTrue((new Rational(-5, 3)).compareTo(new Rational(3, 5)) == -1);

		Assert.assertTrue(Rational.ZERO.compareTo(Rational.ZERO) == 0);
		Assert.assertTrue(Rational.ZERO.compareTo(Rational.ONE) == -1);
		Assert.assertTrue(Rational.ONE.compareTo(Rational.ZERO) == 1);
		Assert.assertTrue(Rational.ZERO.compareTo(Rational.MINUS_ONE) == 1);
		Assert.assertTrue(Rational.MINUS_ONE.compareTo(Rational.ZERO) == -1);
		Assert.assertTrue(Rational.ONE.compareTo(Rational.MINUS_ONE) == 1);
		Assert.assertTrue(Rational.MINUS_ONE.compareTo(Rational.ONE) == -1);
		Assert.assertTrue(Rational.ONE.compareTo(Rational.ONE) == 0);

		// "Rational polymorph compare to"
		Assert.assertTrue((new Rational(3, 5)).compareTo((Object)new Rational(3, 5)) == 0);
		Assert.assertTrue((new Rational(3, 5)).compareTo((Object)new Rational(5, 3)) == -1);
		Assert.assertTrue((new Rational(5, 3)).compareTo((Object)new Rational(3, 5)) == 1);
		Assert.assertTrue((new Rational(3, 5)).compareTo((Object)new Rational(-5, 3)) == 1);
		Assert.assertTrue((new Rational(-5, 3)).compareTo((Object)new Rational(3, 5)) == -1);

		// "Rational small type compare to"
		Assert.assertTrue((new Rational(3, 5)).compareTo(0) != 0);
		Assert.assertTrue((new Rational(0)).compareTo(0) == 0);
		Assert.assertTrue((new Rational(1)).compareTo(1) == 0);
		Assert.assertTrue((new Rational(2)).compareTo(2) == 0);
		Assert.assertTrue((new Rational(3, 5)).compareTo(new Long(0)) != 0);
		Assert.assertTrue((new Rational(1)).compareTo(new Long(1)) == 0);
		Assert.assertTrue((new Rational(1)).compareTo(new Integer(1)) == 0);

		// "Rational long/int value"
		Assert.assertTrue((new Rational(7)).longValue() == 7);
		Assert.assertTrue((new Rational(-7)).intValue() == -7);
		Assert.assertTrue(Rational.ZERO.longValue() == 0);
		Assert.assertTrue(Rational.MINUS_ONE.longValue() == -1);
		Assert.assertTrue(Rational.MINUS_ONE.intValue() == -1);
		Assert.assertTrue(Rational.MINUS_ONE.shortValue() == -1);
		Assert.assertTrue(Rational.MINUS_ONE.byteValue() == -1);
	}
	
	@Test
	public void testRound() {
		Assert.assertTrue((new Rational("23.49")).round(Rational.ROUND_UP).toString().equals("24"));
		Assert.assertTrue((new Rational("23.49")).round(Rational.ROUND_DOWN).toString().equals("23"));
		Assert.assertTrue((new Rational("23.49")).round(Rational.ROUND_CEILING).toString().equals("24"));
		Assert.assertTrue((new Rational("23.49")).round(Rational.ROUND_FLOOR).toString().equals("23"));
		Assert.assertTrue((new Rational("23.49")).round(Rational.ROUND_HALF_UP).toString().equals("23"));
		Assert.assertTrue((new Rational("23.49")).round(Rational.ROUND_HALF_DOWN).toString().equals("23"));
		Assert.assertTrue((new Rational("23.49")).round(Rational.ROUND_HALF_CEILING).toString().equals("23"));
		Assert.assertTrue((new Rational("23.49")).round(Rational.ROUND_HALF_FLOOR).toString().equals("23"));
		Assert.assertTrue((new Rational("23.49")).round(Rational.ROUND_HALF_EVEN).toString().equals("23"));
		Assert.assertTrue((new Rational("23.49")).round(Rational.ROUND_HALF_ODD).toString().equals("23"));

		Assert.assertTrue((new Rational("-23.49")).round(Rational.ROUND_UP).toString().equals("-24"));
		Assert.assertTrue((new Rational("-23.49")).round(Rational.ROUND_DOWN).toString().equals("-23"));
		Assert.assertTrue((new Rational("-23.49")).round(Rational.ROUND_CEILING).toString().equals("-23"));
		Assert.assertTrue((new Rational("-23.49")).round(Rational.ROUND_FLOOR).toString().equals("-24"));
		Assert.assertTrue((new Rational("-23.49")).round(Rational.ROUND_HALF_UP).toString().equals("-23"));
		Assert.assertTrue((new Rational("-23.49")).round(Rational.ROUND_HALF_DOWN).toString().equals("-23"));
		Assert.assertTrue((new Rational("-23.49")).round(Rational.ROUND_HALF_CEILING).toString().equals("-23"));
		Assert.assertTrue((new Rational("-23.49")).round(Rational.ROUND_HALF_FLOOR).toString().equals("-23"));
		Assert.assertTrue((new Rational("-23.49")).round(Rational.ROUND_HALF_EVEN).toString().equals("-23"));
		Assert.assertTrue((new Rational("-23.49")).round(Rational.ROUND_HALF_ODD).toString().equals("-23"));

		Assert.assertTrue((new Rational("23.51")).round(Rational.ROUND_UP).toString().equals("24"));
		Assert.assertTrue((new Rational("23.51")).round(Rational.ROUND_DOWN).toString().equals("23"));
		Assert.assertTrue((new Rational("23.51")).round(Rational.ROUND_CEILING).toString().equals("24"));
		Assert.assertTrue((new Rational("23.51")).round(Rational.ROUND_FLOOR).toString().equals("23"));
		Assert.assertTrue((new Rational("23.51")).round(Rational.ROUND_HALF_UP).toString().equals("24"));
		Assert.assertTrue((new Rational("23.51")).round(Rational.ROUND_HALF_DOWN).toString().equals("24"));
		Assert.assertTrue((new Rational("23.51")).round(Rational.ROUND_HALF_CEILING).toString().equals("24"));
		Assert.assertTrue((new Rational("23.51")).round(Rational.ROUND_HALF_FLOOR).toString().equals("24"));
		Assert.assertTrue((new Rational("23.51")).round(Rational.ROUND_HALF_EVEN).toString().equals("24"));
		Assert.assertTrue((new Rational("23.51")).round(Rational.ROUND_HALF_ODD).toString().equals("24"));

		Assert.assertTrue((new Rational("-23.51")).round(Rational.ROUND_UP).toString().equals("-24"));
		Assert.assertTrue((new Rational("-23.51")).round(Rational.ROUND_DOWN).toString().equals("-23"));
		Assert.assertTrue((new Rational("-23.51")).round(Rational.ROUND_CEILING).toString().equals("-23"));
		Assert.assertTrue((new Rational("-23.51")).round(Rational.ROUND_FLOOR).toString().equals("-24"));
		Assert.assertTrue((new Rational("-23.51")).round(Rational.ROUND_HALF_UP).toString().equals("-24"));
		Assert.assertTrue((new Rational("-23.51")).round(Rational.ROUND_HALF_DOWN).toString().equals("-24"));
		Assert.assertTrue((new Rational("-23.51")).round(Rational.ROUND_HALF_CEILING).toString().equals("-24"));
		Assert.assertTrue((new Rational("-23.51")).round(Rational.ROUND_HALF_FLOOR).toString().equals("-24"));
		Assert.assertTrue((new Rational("-23.51")).round(Rational.ROUND_HALF_EVEN).toString().equals("-24"));
		Assert.assertTrue((new Rational("-23.51")).round(Rational.ROUND_HALF_ODD).toString().equals("-24"));

		Assert.assertTrue((new Rational("23.5")).round(Rational.ROUND_UP).toString().equals("24"));
		Assert.assertTrue((new Rational("23.5")).round(Rational.ROUND_DOWN).toString().equals("23"));
		Assert.assertTrue((new Rational("23.5")).round(Rational.ROUND_CEILING).toString().equals("24"));
		Assert.assertTrue((new Rational("23.5")).round(Rational.ROUND_FLOOR).toString().equals("23"));
		Assert.assertTrue((new Rational("23.5")).round(Rational.ROUND_HALF_UP).toString().equals("24"));
		Assert.assertTrue((new Rational("23.5")).round(Rational.ROUND_HALF_DOWN).toString().equals("23"));
		Assert.assertTrue((new Rational("23.5")).round(Rational.ROUND_HALF_CEILING).toString().equals("24"));
		Assert.assertTrue((new Rational("23.5")).round(Rational.ROUND_HALF_FLOOR).toString().equals("23"));
		Assert.assertTrue((new Rational("23.5")).round(Rational.ROUND_HALF_EVEN).toString().equals("24"));
		Assert.assertTrue((new Rational("23.5")).round(Rational.ROUND_HALF_ODD).toString().equals("23"));

		Assert.assertTrue((new Rational("-23.5")).round(Rational.ROUND_UP).toString().equals("-24"));
		Assert.assertTrue((new Rational("-23.5")).round(Rational.ROUND_DOWN).toString().equals("-23"));
		Assert.assertTrue((new Rational("-23.5")).round(Rational.ROUND_CEILING).toString().equals("-23"));
		Assert.assertTrue((new Rational("-23.5")).round(Rational.ROUND_FLOOR).toString().equals("-24"));
		Assert.assertTrue((new Rational("-23.5")).round(Rational.ROUND_HALF_UP).toString().equals("-24"));
		Assert.assertTrue((new Rational("-23.5")).round(Rational.ROUND_HALF_DOWN).toString().equals("-23"));
		Assert.assertTrue((new Rational("-23.5")).round(Rational.ROUND_HALF_CEILING).toString().equals("-23"));
		Assert.assertTrue((new Rational("-23.5")).round(Rational.ROUND_HALF_FLOOR).toString().equals("-24"));
		Assert.assertTrue((new Rational("-23.5")).round(Rational.ROUND_HALF_EVEN).toString().equals("-24"));
		Assert.assertTrue((new Rational("-23.5")).round(Rational.ROUND_HALF_ODD).toString().equals("-23"));

		Assert.assertTrue((new Rational("22")).round(Rational.ROUND_UP).toString().equals("22"));
		Assert.assertTrue((new Rational("22")).round(Rational.ROUND_DOWN).toString().equals("22"));
		Assert.assertTrue((new Rational("22")).round(Rational.ROUND_CEILING).toString().equals("22"));
		Assert.assertTrue((new Rational("22")).round(Rational.ROUND_FLOOR).toString().equals("22"));
		Assert.assertTrue((new Rational("22")).round(Rational.ROUND_HALF_UP).toString().equals("22"));
		Assert.assertTrue((new Rational("22")).round(Rational.ROUND_HALF_DOWN).toString().equals("22"));
		Assert.assertTrue((new Rational("22")).round(Rational.ROUND_HALF_CEILING).toString().equals("22"));
		Assert.assertTrue((new Rational("22")).round(Rational.ROUND_HALF_FLOOR).toString().equals("22"));
		Assert.assertTrue((new Rational("22")).round(Rational.ROUND_HALF_EVEN).toString().equals("22"));
		Assert.assertTrue((new Rational("22")).round(Rational.ROUND_HALF_ODD).toString().equals("22"));

		Assert.assertTrue((new Rational("-22")).round(Rational.ROUND_UP).toString().equals("-22"));
		Assert.assertTrue((new Rational("-22")).round(Rational.ROUND_DOWN).toString().equals("-22"));
		Assert.assertTrue((new Rational("-22")).round(Rational.ROUND_CEILING).toString().equals("-22"));
		Assert.assertTrue((new Rational("-22")).round(Rational.ROUND_FLOOR).toString().equals("-22"));
		Assert.assertTrue((new Rational("-22")).round(Rational.ROUND_HALF_UP).toString().equals("-22"));
		Assert.assertTrue((new Rational("-22")).round(Rational.ROUND_HALF_DOWN).toString().equals("-22"));
		Assert.assertTrue((new Rational("-22")).round(Rational.ROUND_HALF_CEILING).toString().equals("-22"));
		Assert.assertTrue((new Rational("-22")).round(Rational.ROUND_HALF_FLOOR).toString().equals("-22"));
		Assert.assertTrue((new Rational("-22")).round(Rational.ROUND_HALF_EVEN).toString().equals("-22"));
		Assert.assertTrue((new Rational("-22")).round(Rational.ROUND_HALF_ODD).toString().equals("-22"));

		// "Rational round unnecessary"
		Assert.assertTrue((new Rational("23")).round(Rational.ROUND_UNNECESSARY).toString().equals("23"));
		Assert.assertTrue((new Rational("-23")).round(Rational.ROUND_UNNECESSARY).toString().equals("-23"));
		
		// round special cases
		Assert.assertTrue(Rational.ZERO.round().equals(Rational.ZERO));
		Assert.assertTrue(Rational.ZERO.round(Rational.ROUND_UNNECESSARY).equals(Rational.ZERO));

	}
	
	@Test(expected = ArithmeticException.class)
	public void testIllegalRound1() {
		(new Rational("23.5")).round(Rational.ROUND_UNNECESSARY);
	}
	
	@Test(expected = ArithmeticException.class)
	public void testIllegalRound2() {
		(new Rational("-23.5")).round(Rational.ROUND_UNNECESSARY);
	}
	
	@Test
	public void testIntegerPart() {
		Assert.assertTrue((new Rational("56.8")).integerPart().toString().equals("56"));
		Assert.assertTrue((new Rational("-56.8")).integerPart().toString().equals("-56"));
		Assert.assertTrue((new Rational("0.8")).integerPart().toString().equals("0"));
		Assert.assertTrue((new Rational("-0.8")).integerPart().toString().equals("0"));
	}
	
	@Test
	public void testFractionalPart() {
		Assert.assertTrue((new Rational("56.8")).fractionalPart().equals(new Rational("0.8")));
		Assert.assertTrue((new Rational("-56.8")).fractionalPart().equals(new Rational("-0.8")));
		Assert.assertTrue((new Rational("0.8")).fractionalPart().equals(new Rational("0.8")));
		Assert.assertTrue((new Rational("-0.8")).fractionalPart().equals(new Rational("-0.8")));
	}
	
	@Test
	public void testIntegerAndFractionalPart() {
		Assert.assertTrue((new Rational("56.8")).integerAndFractionalPart()[0].equals(new Rational("56")));
		Assert.assertTrue((new Rational("56.8")).integerAndFractionalPart()[1].equals(new Rational("0.8")));
		Assert.assertTrue((new Rational("-56.8")).integerAndFractionalPart()[0].equals(new Rational("-56")));
		Assert.assertTrue((new Rational("-56.8")).integerAndFractionalPart()[1].equals(new Rational("-0.8")));
	}
	
	@Test
	public void testSanityOfInternalConstants() {
		// sanity/harmlessness of using internal constants of commonly used numbers
		// scanned in by commonly used radixes
		Assert.assertTrue((new Rational("0", 2)).toString(2).equals("0"));
		Assert.assertTrue((new Rational("0", 10)).toString(10).equals("0"));
		Assert.assertTrue((new Rational("0", 16)).toString(16).equals("0"));
		Assert.assertTrue((new Rational("1", 2)).toString(2).equals("1"));
		Assert.assertTrue((new Rational("1", 10)).toString(10).equals("1"));
		Assert.assertTrue((new Rational("1", 16)).toString(16).equals("1"));
		Assert.assertTrue((new Rational("-1", 2)).toString(2).equals("-1"));
		Assert.assertTrue((new Rational("-1", 10)).toString(10).equals("-1"));
		Assert.assertTrue((new Rational("-1", 16)).toString(16).equals("-1"));
		Assert.assertTrue((new Rational("10", 2)).toString(2).equals("10"));
		Assert.assertTrue((new Rational("10", 10)).toString(10).equals("10"));
		Assert.assertTrue((new Rational("10", 16)).toString(16).equals("10"));

		// more constants
		Assert.assertTrue((new Rational("2", 10)).toString(10).equals("2"));
		Assert.assertTrue((new Rational("2", 16)).toString(16).equals("2"));
		Assert.assertTrue((new Rational("-2", 10)).toString(10).equals("-2"));
		Assert.assertTrue((new Rational("-2", 16)).toString(16).equals("-2"));
		Assert.assertTrue((new Rational("16", 10)).toString(10).equals("16"));
		Assert.assertTrue((new Rational("16", 16)).toString(16).equals("16"));
	}
	
	@Test
	public void testValueOfDouble() {
		// floating point
		// remember: [IEEE 754] floats are exact where the quotient is a power of two

		Assert.assertTrue(Rational.valueOf(0.0).equals(Rational.ZERO));
		Assert.assertTrue(Rational.valueOf(1.0).equals(Rational.ONE));
		Assert.assertTrue(Rational.valueOf(-1.0).equals(Rational.MINUS_ONE));

		Assert.assertTrue(Rational.valueOf(2.0).equals(Rational.valueOf(2)));
		Assert.assertTrue(Rational.valueOf(-2.0).equals(Rational.valueOf(-2)));
		Assert.assertTrue(Rational.valueOf(4.0).equals(Rational.valueOf(4)));
		Assert.assertTrue(Rational.valueOf(-4.0).equals(Rational.valueOf(-4)));
		Assert.assertTrue(Rational.valueOf(16.0).equals(Rational.valueOf(16)));
		Assert.assertTrue(Rational.valueOf(-16.0).equals(Rational.valueOf(-16)));

		Assert.assertTrue(Rational.valueOf(3.0).equals(Rational.valueOf(3)));
		Assert.assertTrue(Rational.valueOf(-3.0).equals(Rational.valueOf(-3)));
		Assert.assertTrue(Rational.valueOf(6.0).equals(Rational.valueOf(6)));
		Assert.assertTrue(Rational.valueOf(-6.0).equals(Rational.valueOf(-6)));
		Assert.assertTrue(Rational.valueOf(12.0).equals(Rational.valueOf(12)));
		Assert.assertTrue(Rational.valueOf(-12.0).equals(Rational.valueOf(-12)));

		Assert.assertTrue(Rational.valueOf(0.5).equals(new Rational(1, 2)));
		Assert.assertTrue(Rational.valueOf(-0.5).equals(new Rational(-1, 2)));
		Assert.assertTrue(Rational.valueOf(0.25).equals(new Rational(1, 4)));
		Assert.assertTrue(Rational.valueOf(-0.25).equals(new Rational(-1, 4)));
		Assert.assertTrue(Rational.valueOf(0.0625).equals(new Rational(1, 16)));
		Assert.assertTrue(Rational.valueOf(-0.0625).equals(new Rational(-1, 16)));

		Assert.assertTrue(Rational.valueOf(1.5).equals(new Rational(3, 2)));
		Assert.assertTrue(Rational.valueOf(-1.5).equals(new Rational(-3, 2)));
		Assert.assertTrue(Rational.valueOf(0.75).equals(new Rational(3, 4)));
		Assert.assertTrue(Rational.valueOf(-0.75).equals(new Rational(-3, 4)));
		Assert.assertTrue(Rational.valueOf(0.375).equals(new Rational(3, 8)));
		Assert.assertTrue(Rational.valueOf(-0.375).equals(new Rational(-3, 8)));

		// other conversion direction

		Assert.assertTrue(Rational.ZERO.doubleValue() == 0.0);
		Assert.assertTrue(Rational.ONE.doubleValue() == 1.0);
		Assert.assertTrue(Rational.MINUS_ONE.doubleValue() == -1.0);

		Assert.assertTrue(Rational.valueOf(2).doubleValue() == 2.0);
		Assert.assertTrue(Rational.valueOf(-2).doubleValue() == -2.0);
		Assert.assertTrue(Rational.valueOf(4).doubleValue() == 4.0);
		Assert.assertTrue(Rational.valueOf(-4).doubleValue() == -4.0);
		Assert.assertTrue(Rational.valueOf(16).doubleValue() == 16.0);
		Assert.assertTrue(Rational.valueOf(-16).doubleValue() == -16.0);

		Assert.assertTrue(Rational.valueOf(3).doubleValue() == 3.0);
		Assert.assertTrue(Rational.valueOf(-3).doubleValue() == -3.0);
		Assert.assertTrue(Rational.valueOf(6).doubleValue() == 6.0);
		Assert.assertTrue(Rational.valueOf(-6).doubleValue() == -6.0);
		Assert.assertTrue(Rational.valueOf(12).doubleValue() == 12.0);
		Assert.assertTrue(Rational.valueOf(-12).doubleValue() == -12.0);

		Assert.assertTrue((new Rational(1, 2)).doubleValue() == 0.5);
		Assert.assertTrue((new Rational(-1, 2)).doubleValue() == -0.5);
		Assert.assertTrue((new Rational(1, 4)).doubleValue() == 0.25);
		Assert.assertTrue((new Rational(-1, 4)).doubleValue() == -0.25);
		Assert.assertTrue((new Rational(1, 16)).doubleValue() == 0.0625);
		Assert.assertTrue((new Rational(-1, 16)).doubleValue() == -0.0625);

		Assert.assertTrue((new Rational(3, 2)).doubleValue() == 1.5);
		Assert.assertTrue((new Rational(-3, 2)).doubleValue() == -1.5);
		Assert.assertTrue((new Rational(3, 4)).doubleValue() == 0.75);
		Assert.assertTrue((new Rational(-3, 4)).doubleValue() == -0.75);
		Assert.assertTrue((new Rational(3, 8)).doubleValue() == 0.375);
		Assert.assertTrue((new Rational(-3, 8)).doubleValue() == -0.375);

		// conversion forth and back

		Assert.assertTrue(Rational.valueOf(0.0).doubleValue() == 0.0);
		Assert.assertTrue(Rational.valueOf(1.0).doubleValue() == 1.0);
		Assert.assertTrue(Rational.valueOf(-1.0).doubleValue() == -1.0);
		Assert.assertTrue(Rational.valueOf(2.0).doubleValue() == 2.0);
		Assert.assertTrue(Rational.valueOf(-2.0).doubleValue() == -2.0);

		// maximal and minimal values, and near there
		Assert.assertTrue(Rational.valueOf(Double.MAX_VALUE).doubleValue() == Double.MAX_VALUE);
		Assert.assertTrue(Rational.valueOf(-Double.MAX_VALUE).doubleValue() == -Double.MAX_VALUE);
		Assert.assertTrue(Rational.valueOf(Double.MAX_VALUE / 16).doubleValue() == Double.MAX_VALUE / 16);
		Assert.assertTrue(Rational.valueOf(-Double.MAX_VALUE / 16).doubleValue() == -Double.MAX_VALUE / 16);
		// [subnormal value]
		Assert.assertTrue(Rational.valueOf(Double.MIN_VALUE).doubleValue() == Double.MIN_VALUE);
		Assert.assertTrue(Rational.valueOf(-Double.MIN_VALUE).doubleValue() == -Double.MIN_VALUE);
		Assert.assertTrue(Rational.valueOf(Double.MIN_VALUE * 16).doubleValue() == Double.MIN_VALUE * 16);
		Assert.assertTrue(Rational.valueOf(-Double.MIN_VALUE * 16).doubleValue() == -Double.MIN_VALUE * 16);

		// overflow
		Assert.assertTrue(Rational.valueOf(Double.MAX_VALUE).multiply(2).doubleValue() == Double.POSITIVE_INFINITY);
		Assert.assertTrue(Rational.valueOf(Double.MAX_VALUE).multiply(4).doubleValue() == Double.POSITIVE_INFINITY);
		Assert.assertTrue(Rational.valueOf(Double.MAX_VALUE).multiply(Rational.valueOf(1.2)).doubleValue() == Double.POSITIVE_INFINITY);
		Assert.assertTrue(Rational.valueOf(Double.MAX_VALUE).multiply(16).doubleValue() == Double.POSITIVE_INFINITY);
		Assert.assertTrue(Rational.valueOf(-Double.MAX_VALUE).multiply(2).doubleValue() == Double.NEGATIVE_INFINITY);
		Assert.assertTrue(Rational.valueOf(-Double.MAX_VALUE).multiply(4).doubleValue() == Double.NEGATIVE_INFINITY);
		Assert.assertTrue(Rational.valueOf(-Double.MAX_VALUE).multiply(Rational.valueOf(1.2)).doubleValue() == Double.NEGATIVE_INFINITY);
		Assert.assertTrue(Rational.valueOf(-Double.MAX_VALUE).multiply(16).doubleValue() == Double.NEGATIVE_INFINITY);

		// underflow
		// note that the (double)x==(double)y test yields true for 0.0==-0.0
		Assert.assertTrue(Rational.valueOf(Double.MIN_VALUE).divide(2).doubleValue() == 0.0);
		Assert.assertTrue(Rational.valueOf(Double.MIN_VALUE).divide(4).doubleValue() == 0.0);
		Assert.assertTrue(Rational.valueOf(Double.MIN_VALUE).divide(Rational.valueOf(1.2)).doubleValue() == 0.0);
		Assert.assertTrue(Rational.valueOf(Double.MIN_VALUE).divide(16).doubleValue() == 0.0);
		// returning -0.0 (signed zero)
		Assert.assertTrue(Rational.valueOf(-Double.MIN_VALUE).divide(2).doubleValue() == -0.0);
		Assert.assertTrue(Rational.valueOf(-Double.MIN_VALUE).divide(4).doubleValue() == -0.0);
		Assert.assertTrue(Rational.valueOf(-Double.MIN_VALUE).divide(Rational.valueOf(1.2)).doubleValue() == -0.0);
		Assert.assertTrue(Rational.valueOf(-Double.MIN_VALUE).divide(16).doubleValue() == -0.0);

		// signed underflow, alternative tests
		Assert.assertTrue(String.valueOf(Rational.valueOf(Double.MIN_VALUE).divide(2).doubleValue()).equals("0.0"));
		Assert.assertTrue(String.valueOf(Rational.valueOf(Double.MIN_VALUE).divide(4).doubleValue()).equals("0.0"));
		Assert.assertTrue(String.valueOf(Rational.valueOf(Double.MIN_VALUE).divide(Rational.valueOf(1.2)).doubleValue()).equals("0.0"));
		Assert.assertTrue(String.valueOf(Rational.valueOf(Double.MIN_VALUE).divide(16).doubleValue()).equals("0.0"));
		Assert.assertTrue(String.valueOf(Rational.valueOf(-Double.MIN_VALUE).divide(2).doubleValue()).equals("-0.0"));
		Assert.assertTrue(String.valueOf(Rational.valueOf(-Double.MIN_VALUE).divide(4).doubleValue()).equals("-0.0"));
		Assert.assertTrue(String.valueOf(Rational.valueOf(-Double.MIN_VALUE).divide(Rational.valueOf(1.2)).doubleValue()).equals("-0.0"));
		Assert.assertTrue(String.valueOf(Rational.valueOf(-Double.MIN_VALUE).divide(16).doubleValue()).equals("-0.0"));

		// ulp
		Assert.assertTrue(Rational.valueOf(1.0 - StrictMath.ulp(1.0)).doubleValue() == 1.0 - StrictMath.ulp(1.0));
		Assert.assertTrue(Rational.valueOf(1.0 + StrictMath.ulp(1.0)).doubleValue() == 1.0 + StrictMath.ulp(1.0));
		Assert.assertTrue(Rational.valueOf(1.0 - StrictMath.ulp(1.0) / 2).doubleValue() == 1.0 - StrictMath.ulp(1.0) / 2);
		Assert.assertTrue(Rational.valueOf(1.0 + StrictMath.ulp(1.0) / 2).doubleValue() == 1.0 + StrictMath.ulp(1.0) / 2);
		Assert.assertTrue(Rational.valueOf(1.0 - StrictMath.ulp(1.0) / 4).doubleValue() == 1.0 - StrictMath.ulp(1.0) / 4);
		Assert.assertTrue(Rational.valueOf(1.0 + StrictMath.ulp(1.0) / 4).doubleValue() == 1.0 + StrictMath.ulp(1.0) / 4);

		// mantissa rounding
		// a delta of ulp/4 is expected to be rounded
		Assert.assertTrue(Rational.valueOf(1.0).subtract(Rational.valueOf(StrictMath.ulp(1.0)).divide(4)).doubleValue() == 1.0);
		Assert.assertTrue(Rational.valueOf(16.0).subtract(Rational.valueOf(StrictMath.ulp(16.0)).divide(4)).doubleValue() == 16.0);
		// note: MAX_VALUE is not a power-of-two, so it won't run into the mantissa rounding case in question;
		// and 1/MIN_VALUE is larger than MAX_VALUE (due to MIN_VALUE being subnormal)
		// Assert.assertTrue(Rational.valueOf(0x1P1023).subtract(Rational.valueOf(StrictMath.ulp(0x1P1023)).divide(4)).doubleValue() == 0x1P1023);

		// more values in between [0 and max/min]
		Assert.assertTrue(Rational.valueOf(StrictMath.sqrt(Double.MAX_VALUE)).doubleValue() == StrictMath.sqrt(Double.MAX_VALUE));
		Assert.assertTrue(Rational.valueOf(StrictMath.pow(Double.MAX_VALUE, 0.2)).doubleValue() == StrictMath.pow(Double.MAX_VALUE, 0.2));
		Assert.assertTrue(Rational.valueOf(Double.MAX_VALUE).pow(2).doubleValue() == Double.POSITIVE_INFINITY);
		Assert.assertTrue(Rational.valueOf(Double.MAX_VALUE).pow(5).doubleValue() == Double.POSITIVE_INFINITY);
		Assert.assertTrue(Rational.valueOf(StrictMath.sqrt(Double.MIN_VALUE)).doubleValue() == StrictMath.sqrt(Double.MIN_VALUE));
		Assert.assertTrue(Rational.valueOf(StrictMath.pow(Double.MIN_VALUE, 0.2)).doubleValue() == StrictMath.pow(Double.MIN_VALUE, 0.2));
		Assert.assertTrue(Rational.valueOf(Double.MIN_VALUE).pow(2).doubleValue() == 0.0);
		Assert.assertTrue(Rational.valueOf(Double.MIN_VALUE).pow(5).doubleValue() == 0.0);
		
		Assert.assertTrue(Rational.valueOf(StrictMath.E).doubleValue() == StrictMath.E);
		Assert.assertTrue(Rational.valueOf(StrictMath.PI).doubleValue() == StrictMath.PI);
		Assert.assertTrue(Rational.valueOf(StrictMath.pow(StrictMath.E, 2)).doubleValue() == StrictMath.pow(StrictMath.E, 2));
		Assert.assertTrue(Rational.valueOf(StrictMath.sqrt(StrictMath.E)).doubleValue() == StrictMath.sqrt(StrictMath.E));
		Assert.assertTrue(Rational.valueOf(StrictMath.pow(StrictMath.PI, 2)).doubleValue() == StrictMath.pow(StrictMath.PI, 2));
		Assert.assertTrue(Rational.valueOf(StrictMath.sqrt(StrictMath.PI)).doubleValue() == StrictMath.sqrt(StrictMath.PI));
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalValueOfDoublePositiveInfinity() {
		Rational.valueOf(Double.POSITIVE_INFINITY);
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalValueOfDoubleNegativeInfinity() {
		Rational.valueOf(Double.NEGATIVE_INFINITY);
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalValueOfDoubleNaN() {
		Rational.valueOf(Double.NaN);
	}
	
	@Test
	public void testValueOfFloat() {
		// same tests with single precision float

		Assert.assertTrue(Rational.valueOf(0.0f).equals(Rational.ZERO));
		Assert.assertTrue(Rational.valueOf(1.0f).equals(Rational.ONE));
		Assert.assertTrue(Rational.valueOf(-1.0f).equals(Rational.MINUS_ONE));

		Assert.assertTrue(Rational.valueOf(2.0f).equals(Rational.valueOf(2)));
		Assert.assertTrue(Rational.valueOf(-2.0f).equals(Rational.valueOf(-2)));
		Assert.assertTrue(Rational.valueOf(4.0f).equals(Rational.valueOf(4)));
		Assert.assertTrue(Rational.valueOf(-4.0f).equals(Rational.valueOf(-4)));
		Assert.assertTrue(Rational.valueOf(16.0f).equals(Rational.valueOf(16)));
		Assert.assertTrue(Rational.valueOf(-16.0f).equals(Rational.valueOf(-16)));

		Assert.assertTrue(Rational.valueOf(3.0f).equals(Rational.valueOf(3)));
		Assert.assertTrue(Rational.valueOf(-3.0f).equals(Rational.valueOf(-3)));
		Assert.assertTrue(Rational.valueOf(6.0f).equals(Rational.valueOf(6)));
		Assert.assertTrue(Rational.valueOf(-6.0f).equals(Rational.valueOf(-6)));
		Assert.assertTrue(Rational.valueOf(12.0f).equals(Rational.valueOf(12)));
		Assert.assertTrue(Rational.valueOf(-12.0f).equals(Rational.valueOf(-12)));

		Assert.assertTrue(Rational.valueOf(0.5f).equals(new Rational(1, 2)));
		Assert.assertTrue(Rational.valueOf(-0.5f).equals(new Rational(-1, 2)));
		Assert.assertTrue(Rational.valueOf(0.25f).equals(new Rational(1, 4)));
		Assert.assertTrue(Rational.valueOf(-0.25f).equals(new Rational(-1, 4)));
		Assert.assertTrue(Rational.valueOf(0.0625f).equals(new Rational(1, 16)));
		Assert.assertTrue(Rational.valueOf(-0.0625f).equals(new Rational(-1, 16)));

		Assert.assertTrue(Rational.valueOf(1.5f).equals(new Rational(3, 2)));
		Assert.assertTrue(Rational.valueOf(-1.5f).equals(new Rational(-3, 2)));
		Assert.assertTrue(Rational.valueOf(0.75f).equals(new Rational(3, 4)));
		Assert.assertTrue(Rational.valueOf(-0.75f).equals(new Rational(-3, 4)));
		Assert.assertTrue(Rational.valueOf(0.375f).equals(new Rational(3, 8)));
		Assert.assertTrue(Rational.valueOf(-0.375f).equals(new Rational(-3, 8)));

		// other conversion direction

		Assert.assertTrue(Rational.ZERO.floatValue() == 0.0f);
		Assert.assertTrue(Rational.ONE.floatValue() == 1.0f);
		Assert.assertTrue(Rational.MINUS_ONE.floatValue() == -1.0f);

		Assert.assertTrue(Rational.valueOf(2).floatValue() == 2.0f);
		Assert.assertTrue(Rational.valueOf(-2).floatValue() == -2.0f);
		Assert.assertTrue(Rational.valueOf(4).floatValue() == 4.0f);
		Assert.assertTrue(Rational.valueOf(-4).floatValue() == -4.0f);
		Assert.assertTrue(Rational.valueOf(16).floatValue() == 16.0f);
		Assert.assertTrue(Rational.valueOf(-16).floatValue() == -16.0f);

		Assert.assertTrue(Rational.valueOf(3).floatValue() == 3.0f);
		Assert.assertTrue(Rational.valueOf(-3).floatValue() == -3.0f);
		Assert.assertTrue(Rational.valueOf(6).floatValue() == 6.0f);
		Assert.assertTrue(Rational.valueOf(-6).floatValue() == -6.0f);
		Assert.assertTrue(Rational.valueOf(12).floatValue() == 12.0f);
		Assert.assertTrue(Rational.valueOf(-12).floatValue() == -12.0f);

		Assert.assertTrue((new Rational(1, 2)).floatValue() == 0.5f);
		Assert.assertTrue((new Rational(-1, 2)).floatValue() == -0.5f);
		Assert.assertTrue((new Rational(1, 4)).floatValue() == 0.25f);
		Assert.assertTrue((new Rational(-1, 4)).floatValue() == -0.25f);
		Assert.assertTrue((new Rational(1, 16)).floatValue() == 0.0625f);
		Assert.assertTrue((new Rational(-1, 16)).floatValue() == -0.0625f);

		Assert.assertTrue((new Rational(3, 2)).floatValue() == 1.5f);
		Assert.assertTrue((new Rational(-3, 2)).floatValue() == -1.5f);
		Assert.assertTrue((new Rational(3, 4)).floatValue() == 0.75f);
		Assert.assertTrue((new Rational(-3, 4)).floatValue() == -0.75f);
		Assert.assertTrue((new Rational(3, 8)).floatValue() == 0.375f);
		Assert.assertTrue((new Rational(-3, 8)).floatValue() == -0.375f);

		// conversion forth and back

		Assert.assertTrue(Rational.valueOf(0.0f).floatValue() == 0.0f);
		Assert.assertTrue(Rational.valueOf(1.0f).floatValue() == 1.0f);
		Assert.assertTrue(Rational.valueOf(-1.0f).floatValue() == -1.0f);
		Assert.assertTrue(Rational.valueOf(2.0f).floatValue() == 2.0f);
		Assert.assertTrue(Rational.valueOf(-2.0f).floatValue() == -2.0f);

		// maximal and minimal values, and near there
		Assert.assertTrue(Rational.valueOf(Float.MAX_VALUE).floatValue() == Float.MAX_VALUE);
		Assert.assertTrue(Rational.valueOf(-Float.MAX_VALUE).floatValue() == -Float.MAX_VALUE);
		Assert.assertTrue(Rational.valueOf(Float.MAX_VALUE / 16).floatValue() == Float.MAX_VALUE / 16);
		Assert.assertTrue(Rational.valueOf(-Float.MAX_VALUE / 16).floatValue() == -Float.MAX_VALUE / 16);
		// [subnormal value]
		Assert.assertTrue(Rational.valueOf(Float.MIN_VALUE).floatValue() == Float.MIN_VALUE);
		Assert.assertTrue(Rational.valueOf(-Float.MIN_VALUE).floatValue() == -Float.MIN_VALUE);
		Assert.assertTrue(Rational.valueOf(Float.MIN_VALUE * 16).floatValue() == Float.MIN_VALUE * 16);
		Assert.assertTrue(Rational.valueOf(-Float.MIN_VALUE * 16).floatValue() == -Float.MIN_VALUE * 16);

		// overflow
		Assert.assertTrue(Rational.valueOf(Float.MAX_VALUE).multiply(2).floatValue() == Float.POSITIVE_INFINITY);
		Assert.assertTrue(Rational.valueOf(Float.MAX_VALUE).multiply(4).floatValue() == Float.POSITIVE_INFINITY);
		Assert.assertTrue(Rational.valueOf(Float.MAX_VALUE).multiply(Rational.valueOf(1.2f)).floatValue() == Float.POSITIVE_INFINITY);
		Assert.assertTrue(Rational.valueOf(Float.MAX_VALUE).multiply(16).floatValue() == Float.POSITIVE_INFINITY);
		Assert.assertTrue(Rational.valueOf(-Float.MAX_VALUE).multiply(2).floatValue() == Float.NEGATIVE_INFINITY);
		Assert.assertTrue(Rational.valueOf(-Float.MAX_VALUE).multiply(4).floatValue() == Float.NEGATIVE_INFINITY);
		Assert.assertTrue(Rational.valueOf(-Float.MAX_VALUE).multiply(Rational.valueOf(1.2f)).floatValue() == Float.NEGATIVE_INFINITY);
		Assert.assertTrue(Rational.valueOf(-Float.MAX_VALUE).multiply(16).floatValue() == Float.NEGATIVE_INFINITY);

		// underflow
		// note that the (float)x==(float)y test yields true for 0.0f==-0.0f
		Assert.assertTrue(Rational.valueOf(Float.MIN_VALUE).divide(2).floatValue() == 0.0f);
		Assert.assertTrue(Rational.valueOf(Float.MIN_VALUE).divide(4).floatValue() == 0.0f);
		Assert.assertTrue(Rational.valueOf(Float.MIN_VALUE).divide(Rational.valueOf(1.2f)).floatValue() == 0.0f);
		Assert.assertTrue(Rational.valueOf(Float.MIN_VALUE).divide(16).floatValue() == 0.0f);
		// returning -0.0f (signed zero)
		Assert.assertTrue(Rational.valueOf(-Float.MIN_VALUE).divide(2).floatValue() == -0.0f);
		Assert.assertTrue(Rational.valueOf(-Float.MIN_VALUE).divide(4).floatValue() == -0.0f);
		Assert.assertTrue(Rational.valueOf(-Float.MIN_VALUE).divide(Rational.valueOf(1.2f)).floatValue() == -0.0f);
		Assert.assertTrue(Rational.valueOf(-Float.MIN_VALUE).divide(16).floatValue() == -0.0f);

		// signed underflow, alternative tests
		Assert.assertTrue(String.valueOf(Rational.valueOf(Float.MIN_VALUE).divide(2).floatValue()).equals("0.0"));
		Assert.assertTrue(String.valueOf(Rational.valueOf(Float.MIN_VALUE).divide(4).floatValue()).equals("0.0"));
		Assert.assertTrue(String.valueOf(Rational.valueOf(Float.MIN_VALUE).divide(Rational.valueOf(1.2f)).floatValue()).equals("0.0"));
		Assert.assertTrue(String.valueOf(Rational.valueOf(Float.MIN_VALUE).divide(16).floatValue()).equals("0.0"));
		Assert.assertTrue(String.valueOf(Rational.valueOf(-Float.MIN_VALUE).divide(2).floatValue()).equals("-0.0"));
		Assert.assertTrue(String.valueOf(Rational.valueOf(-Float.MIN_VALUE).divide(4).floatValue()).equals("-0.0"));
		Assert.assertTrue(String.valueOf(Rational.valueOf(-Float.MIN_VALUE).divide(Rational.valueOf(1.2f)).floatValue()).equals("-0.0"));
		Assert.assertTrue(String.valueOf(Rational.valueOf(-Float.MIN_VALUE).divide(16).floatValue()).equals("-0.0"));

		// ulp
		Assert.assertTrue(Rational.valueOf(1.0f - StrictMath.ulp(1.0f)).floatValue() == 1.0f - StrictMath.ulp(1.0f));
		Assert.assertTrue(Rational.valueOf(1.0f + StrictMath.ulp(1.0f)).floatValue() == 1.0f + StrictMath.ulp(1.0f));
		Assert.assertTrue(Rational.valueOf(1.0f - StrictMath.ulp(1.0f) / 2).floatValue() == 1.0f - StrictMath.ulp(1.0f) / 2);
		Assert.assertTrue(Rational.valueOf(1.0f + StrictMath.ulp(1.0f) / 2).floatValue() == 1.0f + StrictMath.ulp(1.0f) / 2);
		Assert.assertTrue(Rational.valueOf(1.0f - StrictMath.ulp(1.0f) / 4).floatValue() == 1.0f - StrictMath.ulp(1.0f) / 4);
		Assert.assertTrue(Rational.valueOf(1.0f + StrictMath.ulp(1.0f) / 4).floatValue() == 1.0f + StrictMath.ulp(1.0f) / 4);

		// mantissa rounding
		// a delta of ulp/4 is expected to be rounded
		Assert.assertTrue(Rational.valueOf(1.0f).subtract(Rational.valueOf(StrictMath.ulp(1.0f)).divide(4)).floatValue() == 1.0f);
		Assert.assertTrue(Rational.valueOf(16.0f).subtract(Rational.valueOf(StrictMath.ulp(16.0f)).divide(4)).floatValue() == 16.0f);
		// note: MAX_VALUE is not a power-of-two, so it won't run into the mantissa rounding case in question;
		// and 1/MIN_VALUE is larger than MAX_VALUE (due to MIN_VALUE being subnormal)
		// Assert.assertTrue(Rational.valueOf(0x1P127f).subtract(Rational.valueOf(StrictMath.ulp(0x1P127f)).divide(4)).floatValue() == 0x1P127f);

		// more values in between [0 and max/min]
		Assert.assertTrue(Rational.valueOf((float)StrictMath.sqrt(Float.MAX_VALUE)).floatValue() == (float)StrictMath.sqrt(Float.MAX_VALUE));
		Assert.assertTrue(Rational.valueOf((float)StrictMath.pow(Float.MAX_VALUE, 0.2f)).floatValue() == (float)StrictMath.pow(Float.MAX_VALUE, 0.2f));
		Assert.assertTrue(Rational.valueOf(Float.MAX_VALUE).pow(2).floatValue() == Float.POSITIVE_INFINITY);
		Assert.assertTrue(Rational.valueOf(Float.MAX_VALUE).pow(5).floatValue() == Float.POSITIVE_INFINITY);
		Assert.assertTrue(Rational.valueOf((float)StrictMath.sqrt(Float.MIN_VALUE)).floatValue() == (float)StrictMath.sqrt(Float.MIN_VALUE));
		Assert.assertTrue(Rational.valueOf((float)StrictMath.pow(Float.MIN_VALUE, 0.2f)).floatValue() == (float)StrictMath.pow(Float.MIN_VALUE, 0.2f));
		Assert.assertTrue(Rational.valueOf(Float.MIN_VALUE).pow(2).floatValue() == 0.0f);
		Assert.assertTrue(Rational.valueOf(Float.MIN_VALUE).pow(5).floatValue() == 0.0f);
		
		Assert.assertTrue(Rational.valueOf((float)StrictMath.E).floatValue() == (float)StrictMath.E);
		Assert.assertTrue(Rational.valueOf((float)StrictMath.PI).floatValue() == (float)StrictMath.PI);
		Assert.assertTrue(Rational.valueOf((float)StrictMath.pow((float)StrictMath.E, 2)).floatValue() == (float)StrictMath.pow((float)StrictMath.E, 2));
		Assert.assertTrue(Rational.valueOf((float)StrictMath.sqrt((float)StrictMath.E)).floatValue() == (float)StrictMath.sqrt((float)StrictMath.E));
		Assert.assertTrue(Rational.valueOf((float)StrictMath.pow((float)StrictMath.PI, 2)).floatValue() == (float)StrictMath.pow((float)StrictMath.PI, 2));
		Assert.assertTrue(Rational.valueOf((float)StrictMath.sqrt((float)StrictMath.PI)).floatValue() == (float)StrictMath.sqrt((float)StrictMath.PI));
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalValueOfFloatPositiveInfinity() {
		Rational.valueOf(Float.POSITIVE_INFINITY);
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalValueOfFloatNegativeInfinity() {
		Rational.valueOf(Float.NEGATIVE_INFINITY);
	}
	
	@Test(expected = NumberFormatException.class)
	public void testIllegalValueOfFloatNaN() {
		Rational.valueOf(Float.NaN);
	}
	
	@Test
	public void testValueOfBits() {
		// half (5 exponent bits)
		Assert.assertTrue(Rational.valueOfHalfBits((short)0).equals(Rational.valueOf("0")));
		Assert.assertTrue(Rational.valueOf("0").halfBitsValue() == 0);
		Assert.assertTrue(Rational.valueOfHalfBits((short)0x3c00).equals(Rational.valueOf("1")));
		Assert.assertTrue(Rational.valueOf("1").halfBitsValue() == (short)0x3c00);
		Assert.assertTrue(Rational.valueOfHalfBits((short)0xbc00).equals(Rational.valueOf("-1")));
		Assert.assertTrue(Rational.valueOf("-1").halfBitsValue() == (short)0xbc00);
		Assert.assertTrue(Rational.valueOfHalfBits((short)0x3e00).equals(Rational.valueOf("1.5")));
		Assert.assertTrue(Rational.valueOf("1.5").halfBitsValue() == (short)0x3e00);
		Assert.assertTrue(Rational.valueOfHalfBits((short)0xbe00).equals(Rational.valueOf("-1.5")));
		Assert.assertTrue(Rational.valueOf("-1.5").halfBitsValue() == (short)0xbe00);
		Assert.assertTrue(Rational.valueOfHalfBits((short)0x3f00).equals(Rational.valueOf("1.75")));
		Assert.assertTrue(Rational.valueOf("1.75").halfBitsValue() == (short)0x3f00);
		Assert.assertTrue(Rational.valueOfHalfBits((short)0xbf00).equals(Rational.valueOf("-1.75")));
		Assert.assertTrue(Rational.valueOf("-1.75").halfBitsValue() == (short)0xbf00);

		// float (8 exponent bits)
		Assert.assertTrue(Rational.valueOfFloatBits(0).equals(Rational.valueOf("0")));
		Assert.assertTrue(Rational.valueOf("0").floatBitsValue() == 0);
		Assert.assertTrue(Rational.valueOfFloatBits(0x3f800000).equals(Rational.valueOf("1")));
		Assert.assertTrue(Rational.valueOf("1").floatBitsValue() == 0x3f800000);
		Assert.assertTrue(Rational.valueOfFloatBits(0xbf800000).equals(Rational.valueOf("-1")));
		Assert.assertTrue(Rational.valueOf("-1").floatBitsValue() == 0xbf800000);
		Assert.assertTrue(Rational.valueOfFloatBits(0x3fc00000).equals(Rational.valueOf("1.5")));
		Assert.assertTrue(Rational.valueOf("1.5").floatBitsValue() == 0x3fc00000);
		Assert.assertTrue(Rational.valueOfFloatBits(0xbfc00000).equals(Rational.valueOf("-1.5")));
		Assert.assertTrue(Rational.valueOf("-1.5").floatBitsValue() == 0xbfc00000);
		Assert.assertTrue(Rational.valueOfFloatBits(0x3fe00000).equals(Rational.valueOf("1.75")));
		Assert.assertTrue(Rational.valueOf("1.75").floatBitsValue() == 0x3fe00000);
		Assert.assertTrue(Rational.valueOfFloatBits(0xbfe00000).equals(Rational.valueOf("-1.75")));
		Assert.assertTrue(Rational.valueOf("-1.75").floatBitsValue() == 0xbfe00000);

		// double (11 exponent bits)
		Assert.assertTrue(Rational.valueOfDoubleBits(0).equals(Rational.valueOf("0")));
		Assert.assertTrue(Rational.valueOf("0").doubleBitsValue() == 0);
		Assert.assertTrue(Rational.valueOfDoubleBits(0x3ff0000000000000l).equals(Rational.valueOf("1")));
		Assert.assertTrue(Rational.valueOf("1").doubleBitsValue() == 0x3ff0000000000000l);
		Assert.assertTrue(Rational.valueOfDoubleBits(0xbff0000000000000l).equals(Rational.valueOf("-1")));
		Assert.assertTrue(Rational.valueOf("-1").doubleBitsValue() == 0xbff0000000000000l);
		Assert.assertTrue(Rational.valueOfDoubleBits(0x3ff8000000000000l).equals(Rational.valueOf("1.5")));
		Assert.assertTrue(Rational.valueOf("1.5").doubleBitsValue() == 0x3ff8000000000000l);
		Assert.assertTrue(Rational.valueOfDoubleBits(0xbff8000000000000l).equals(Rational.valueOf("-1.5")));
		Assert.assertTrue(Rational.valueOf("-1.5").doubleBitsValue() == 0xbff8000000000000l);
		Assert.assertTrue(Rational.valueOfDoubleBits(0x3ffc000000000000l).equals(Rational.valueOf("1.75")));
		Assert.assertTrue(Rational.valueOf("1.75").doubleBitsValue() == 0x3ffc000000000000l);
		Assert.assertTrue(Rational.valueOfDoubleBits(0xbffc000000000000l).equals(Rational.valueOf("-1.75")));
		Assert.assertTrue(Rational.valueOf("-1.75").doubleBitsValue() == 0xbffc000000000000l);

		// quadBitsEqual
		Assert.assertTrue(Rational.quadBitsEqual(new long[] {0xfffeffffffffffffl, 0xffffffffffffffffl,}, new long[] {0xfffeffffffffffffl, 0xffffffffffffffffl,}));
		Assert.assertTrue(!Rational.quadBitsEqual(new long[] {0xfffeffffffffffffl, 0xffffffffffffffffl,}, new long[] {0xffffffffffffffffl, 0xfffeffffffffffffl,}));

		// quad (15 exponent bits)
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOf("0").quadBitsValue(), new long[] {0, 0,}));
		Assert.assertTrue(Rational.valueOfQuadBits(new long[] {0x3fff000000000000l, 0,}).equals(Rational.valueOf("1")));
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOf("1").quadBitsValue(), new long[] {0x3fff000000000000l, 0,}));
		Assert.assertTrue(Rational.valueOfQuadBits(new long[] {0xbfff000000000000l, 0,}).equals(Rational.valueOf("-1")));
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOf("-1").quadBitsValue(), new long[] {0xbfff000000000000l, 0,}));
		Assert.assertTrue(Rational.valueOfQuadBits(new long[] {0x3fff800000000000l, 0,}).equals(Rational.valueOf("1.5")));
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOf("1.5").quadBitsValue(), new long[] {0x3fff800000000000l, 0,}));
		Assert.assertTrue(Rational.valueOfQuadBits(new long[] {0xbfff800000000000l, 0,}).equals(Rational.valueOf("-1.5")));
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOf("-1.5").quadBitsValue(), new long[] {0xbfff800000000000l, 0,}));
		Assert.assertTrue(Rational.valueOfQuadBits(new long[] {0x3fffc00000000000l, 0,}).equals(Rational.valueOf("1.75")));
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOf("1.75").quadBitsValue(), new long[] {0x3fffc00000000000l, 0,}));
		Assert.assertTrue(Rational.valueOfQuadBits(new long[] {0xbfffc00000000000l, 0,}).equals(Rational.valueOf("-1.75")));
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOf("-1.75").quadBitsValue(), new long[] {0xbfffc00000000000l, 0,}));

		// more quad tests
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOfQuadBits(new long[] {0x0000000000000000l, 0x0000000000000000l,}).quadBitsValue(), new long[] {0x0000000000000000l, 0x0000000000000000l,}));
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOfQuadBits(new long[] {0x0000000000000001l, 0x0000000000000000l,}).quadBitsValue(), new long[] {0x0000000000000001l, 0x0000000000000000l,}));
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOfQuadBits(new long[] {0x0000000000000000l, 0x8000000000000000l,}).quadBitsValue(), new long[] {0x0000000000000000l, 0x8000000000000000l,}));
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOfQuadBits(new long[] {0x0000000000000000l, 0x0000000000000001l,}).quadBitsValue(), new long[] {0x0000000000000000l, 0x0000000000000001l,}));
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOfQuadBits(new long[] {0x0000000000000002l, 0x0000000000000000l,}).quadBitsValue(), new long[] {0x0000000000000002l, 0x0000000000000000l,}));
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOfQuadBits(new long[] {0x0000000000000000l, 0x4000000000000000l,}).quadBitsValue(), new long[] {0x0000000000000000l, 0x4000000000000000l,}));
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOfQuadBits(new long[] {0x0000000000000000l, 0x0000000000000002l,}).quadBitsValue(), new long[] {0x0000000000000000l, 0x0000000000000002l,}));
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOfQuadBits(new long[] {0x7ffe000000000000l, 0x0000000000000000l,}).quadBitsValue(), new long[] {0x7ffe000000000000l, 0x0000000000000000l,}));
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOfQuadBits(new long[] {0x7ffe000000000001l, 0x0000000000000000l,}).quadBitsValue(), new long[] {0x7ffe000000000001l, 0x0000000000000000l,}));
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOfQuadBits(new long[] {0x7ffe000000000000l, 0x8000000000000000l,}).quadBitsValue(), new long[] {0x7ffe000000000000l, 0x8000000000000000l,}));
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOfQuadBits(new long[] {0x7ffe000000000000l, 0x0000000000000001l,}).quadBitsValue(), new long[] {0x7ffe000000000000l, 0x0000000000000001l,}));
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOfQuadBits(new long[] {0x7ffe000000000002l, 0x0000000000000000l,}).quadBitsValue(), new long[] {0x7ffe000000000002l, 0x0000000000000000l,}));
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOfQuadBits(new long[] {0x7ffe000000000000l, 0x4000000000000000l,}).quadBitsValue(), new long[] {0x7ffe000000000000l, 0x4000000000000000l,}));
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOfQuadBits(new long[] {0x7ffe000000000000l, 0x0000000000000002l,}).quadBitsValue(), new long[] {0x7ffe000000000000l, 0x0000000000000002l,}));

		// forth and back

		// most bits possible set (i.e. largest negative)
		Assert.assertTrue(Rational.valueOfHalfBits((short)0xfbff).halfBitsValue() == (short)0xfbff);
		Assert.assertTrue(Rational.valueOfFloatBits(0xff7fffff).floatBitsValue() == 0xff7fffff);
		Assert.assertTrue(Rational.valueOfDoubleBits(0xffefffffffffffffl).doubleBitsValue() == 0xffefffffffffffffl);
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOfQuadBits(new long[] {0xfffeffffffffffffl, 0xffffffffffffffffl,}).quadBitsValue(), new long[] {0xfffeffffffffffffl, 0xffffffffffffffffl,}));

		// smallest non-subnormal number
		Assert.assertTrue(Rational.valueOfHalfBits((short)0x0400).halfBitsValue() == (short)0x0400);
		Assert.assertTrue(Rational.valueOfFloatBits(0x00800000).floatBitsValue() == 0x00800000);
		Assert.assertTrue(Rational.valueOfDoubleBits(0x0010000000000000l).doubleBitsValue() == 0x0010000000000000l);
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOfQuadBits(new long[] {0x0001000000000000l, 0x0000000000000000l,}).quadBitsValue(), new long[] {0x0001000000000000l, 0x0000000000000000l,}));
		// largest subnormal number
		Assert.assertTrue(Rational.valueOfHalfBits((short)0x02ff).halfBitsValue() == (short)0x02ff);
		Assert.assertTrue(Rational.valueOfFloatBits(0x004fffff).floatBitsValue() == 0x004fffff);
		Assert.assertTrue(Rational.valueOfDoubleBits(0x0008ffffffffffffl).doubleBitsValue() == 0x0008ffffffffffffl);
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOfQuadBits(new long[] {0x00008fffffffffffl, 0xffffffffffffffffl,}).quadBitsValue(), new long[] {0x00008fffffffffffl, 0xffffffffffffffffl,}));
		// largest subnormal number with one bit set only
		Assert.assertTrue(Rational.valueOfHalfBits((short)0x0200).halfBitsValue() == (short)0x0200);
		Assert.assertTrue(Rational.valueOfFloatBits(0x00400000).floatBitsValue() == 0x00400000);
		Assert.assertTrue(Rational.valueOfDoubleBits(0x0008000000000000l).doubleBitsValue() == 0x0008000000000000l);
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOfQuadBits(new long[] {0x0000800000000000l, 0x0000000000000000l,}).quadBitsValue(), new long[] {0x0000800000000000l, 0x0000000000000000l,}));
		// one less of above
		Assert.assertTrue(Rational.valueOfHalfBits((short)0x01ff).halfBitsValue() == (short)0x01ff);
		Assert.assertTrue(Rational.valueOfFloatBits(0x003fffff).floatBitsValue() == 0x003fffff);
		Assert.assertTrue(Rational.valueOfDoubleBits(0x0007ffffffffffffl).doubleBitsValue() == 0x0007ffffffffffffl);
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOfQuadBits(new long[] {0x00007fffffffffffl, 0xffffffffffffffffl,}).quadBitsValue(), new long[] {0x00007fffffffffffl, 0xffffffffffffffffl,}));
		// half of above
		Assert.assertTrue(Rational.valueOfHalfBits((short)0x0100).halfBitsValue() == (short)0x0100);
		Assert.assertTrue(Rational.valueOfFloatBits(0x00200000).floatBitsValue() == 0x00200000);
		Assert.assertTrue(Rational.valueOfDoubleBits(0x0004000000000000l).doubleBitsValue() == 0x0004000000000000l);
		Assert.assertTrue(Rational.quadBitsEqual(Rational.valueOfQuadBits(new long[] {0x0000400000000000l, 0x0000000000000000l,}).quadBitsValue(), new long[] {0x0000400000000000l, 0x0000000000000000l,}));

		// round-off vs. exact
		Assert.assertTrue(Rational.valueOfHalfBits(Rational.valueOf("0.125").halfBitsValue()).equals(Rational.valueOf("0.125")));
		Assert.assertTrue(Rational.valueOfFloatBits(Rational.valueOf("0.125").floatBitsValue()).equals(Rational.valueOf("0.125")));
		Assert.assertTrue(Rational.valueOfDoubleBits(Rational.valueOf("0.125").doubleBitsValue()).equals(Rational.valueOf("0.125")));
		Assert.assertTrue(Rational.valueOfQuadBits(Rational.valueOf("0.125").quadBitsValue()).equals(Rational.valueOf("0.125")));
		Assert.assertTrue(!Rational.valueOfHalfBits(Rational.valueOf("0.1").halfBitsValue()).equals(Rational.valueOf("0.1")));
		Assert.assertTrue(!Rational.valueOfFloatBits(Rational.valueOf("0.1").floatBitsValue()).equals(Rational.valueOf("0.1")));
		Assert.assertTrue(!Rational.valueOfDoubleBits(Rational.valueOf("0.1").doubleBitsValue()).equals(Rational.valueOf("0.1")));
		Assert.assertTrue(!Rational.valueOfQuadBits(Rational.valueOf("0.1").quadBitsValue()).equals(Rational.valueOf("0.1")));
	}
}
